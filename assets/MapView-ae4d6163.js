import{r as f,_ as mt,a as st,u as pt,j as _}from"./index-77827b4c.js";import{U as gt}from"./Return-7feaa692.js";import"./Modal-c26335ab.js";import"./transition-80610d22.js";import"./deleteNotAtHome-63823a81.js";import"./Disclosure-33565afa.js";import"./upDownArrow-4f99c3cf.js";const yt=f.createContext(null);function vt(n){const t=n.clone();return t.pixelsToGLUnits=n.pixelsToGLUnits,t}function q(n){return{longitude:n.center.lng,latitude:n.center.lat,zoom:n.zoom,pitch:n.pitch,bearing:n.bearing,padding:n.padding}}function G(n,t){const e=t.viewState||t;let r=!1;if("longitude"in e&&"latitude"in e){const o=n.center;n.center=new o.constructor(e.longitude,e.latitude),r=r||o!==n.center}if("zoom"in e){const o=n.zoom;n.zoom=e.zoom,r=r||o!==n.zoom}if("bearing"in e){const o=n.bearing;n.bearing=e.bearing,r=r||o!==n.bearing}if("pitch"in e){const o=n.pitch;n.pitch=e.pitch,r=r||o!==n.pitch}return e.padding&&!n.isPaddingEqual(e.padding)&&(r=!0,n.padding=e.padding),r}const _t=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function Q(n){if(!n)return null;if(typeof n=="string"||("toJS"in n&&(n=n.toJS()),!n.layers))return n;const t={};for(const r of n.layers)t[r.id]=r;const e=n.layers.map(r=>{const o=t[r.ref];let i=null;if("interactive"in r&&(i={...r},delete i.interactive),o){i=i||{...r},delete i.ref;for(const a of _t)a in o&&(i[a]=o[a])}return i||r});return{...n,layers:e}}function wt(n,t){const e=Array.isArray(n)?n[0]:n?n.x:0,r=Array.isArray(n)?n[1]:n?n.y:0,o=Array.isArray(t)?t[0]:t?t.x:0,i=Array.isArray(t)?t[1]:t?t.y:0;return e===o&&r===i}function C(n,t){if(n===t)return!0;if(!n||!t)return!1;if(Array.isArray(n)){if(!Array.isArray(t)||n.length!==t.length)return!1;for(let e=0;e<n.length;e++)if(!C(n[e],t[e]))return!1;return!0}else if(Array.isArray(t))return!1;if(typeof n=="object"&&typeof t=="object"){const e=Object.keys(n),r=Object.keys(t);if(e.length!==r.length)return!1;for(const o of e)if(!t.hasOwnProperty(o)||!C(n[o],t[o]))return!1;return!0}return!1}const J={mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",click:"onClick",dblclick:"onDblClick",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",mouseout:"onMouseOut",contextmenu:"onContextMenu",touchstart:"onTouchStart",touchend:"onTouchEnd",touchmove:"onTouchMove",touchcancel:"onTouchCancel"},I={movestart:"onMoveStart",move:"onMove",moveend:"onMoveEnd",dragstart:"onDragStart",drag:"onDrag",dragend:"onDragEnd",zoomstart:"onZoomStart",zoom:"onZoom",zoomend:"onZoomEnd",rotatestart:"onRotateStart",rotate:"onRotate",rotateend:"onRotateEnd",pitchstart:"onPitchStart",pitch:"onPitch",pitchend:"onPitchEnd"},K={wheel:"onWheel",boxzoomstart:"onBoxZoomStart",boxzoomend:"onBoxZoomEnd",boxzoomcancel:"onBoxZoomCancel",resize:"onResize",load:"onLoad",render:"onRender",idle:"onIdle",remove:"onRemove",data:"onData",styledata:"onStyleData",sourcedata:"onSourceData",error:"onError"},xt=["minZoom","maxZoom","minPitch","maxPitch","maxBounds","projection","renderWorldCopies"],Et=["scrollZoom","boxZoom","dragRotate","dragPan","keyboard","doubleClickZoom","touchZoomRotate","touchPitch"];class R{constructor(t,e,r){this._map=null,this._internalUpdate=!1,this._inRender=!1,this._hoveredFeatures=null,this._deferredEvents={move:!1,zoom:!1,pitch:!1,rotate:!1},this._onEvent=o=>{const i=this.props[K[o.type]];i&&i(o)},this._onPointerEvent=o=>{(o.type==="mousemove"||o.type==="mouseout")&&this._updateHover(o);const i=this.props[J[o.type]];i&&(this.props.interactiveLayerIds&&o.type!=="mouseover"&&o.type!=="mouseout"&&(o.features=this._hoveredFeatures||this._queryRenderedFeatures(o.point)),i(o),delete o.features)},this._onCameraEvent=o=>{if(!this._internalUpdate){const i=this.props[I[o.type]];i&&i(o)}o.type in this._deferredEvents&&(this._deferredEvents[o.type]=!1)},this._MapClass=t,this.props=e,this._initialize(r)}get map(){return this._map}get transform(){return this._renderTransform}setProps(t){const e=this.props;this.props=t;const r=this._updateSettings(t,e);r&&this._createShadowTransform(this._map);const o=this._updateSize(t),i=this._updateViewState(t,!0);this._updateStyle(t,e),this._updateStyleComponents(t,e),this._updateHandlers(t,e),(r||o||i&&!this._map.isMoving())&&this.redraw()}static reuse(t,e){const r=R.savedMaps.pop();if(!r)return null;const o=r.map,i=o.getContainer();for(e.className=i.className;i.childNodes.length>0;)e.appendChild(i.childNodes[0]);o._container=e;const a=o._resizeObserver;a&&(a.disconnect(),a.observe(e)),r.setProps({...t,styleDiffing:!1}),o.resize();const{initialViewState:l}=t;return l&&(l.bounds?o.fitBounds(l.bounds,{...l.fitBoundsOptions,duration:0}):r._updateViewState(l,!1)),o.isStyleLoaded()?o.fire("load"):o.once("styledata",()=>o.fire("load")),o._update(),r}_initialize(t){const{props:e}=this,r={...e,...e.initialViewState,accessToken:e.mapboxAccessToken||Mt()||null,container:t,style:Q(e.mapStyle)},o=r.initialViewState||r.viewState||r;if(Object.assign(r,{center:[o.longitude||0,o.latitude||0],zoom:o.zoom||0,pitch:o.pitch||0,bearing:o.bearing||0}),e.gl){const c=HTMLCanvasElement.prototype.getContext;HTMLCanvasElement.prototype.getContext=()=>(HTMLCanvasElement.prototype.getContext=c,e.gl)}const i=new this._MapClass(r);o.padding&&i.setPadding(o.padding),e.cursor&&(i.getCanvas().style.cursor=e.cursor),this._createShadowTransform(i);const a=i._render;i._render=c=>{this._inRender=!0,a.call(i,c),this._inRender=!1};const l=i._renderTaskQueue.run;i._renderTaskQueue.run=c=>{l.call(i._renderTaskQueue,c),this._onBeforeRepaint()},i.on("render",()=>this._onAfterRepaint());const s=i.fire;i.fire=this._fireEvent.bind(this,s),i.on("resize",()=>{this._renderTransform.resize(i.transform.width,i.transform.height)}),i.on("styledata",()=>this._updateStyleComponents(this.props,{})),i.on("sourcedata",()=>this._updateStyleComponents(this.props,{}));for(const c in J)i.on(c,this._onPointerEvent);for(const c in I)i.on(c,this._onCameraEvent);for(const c in K)i.on(c,this._onEvent);this._map=i}recycle(){const e=this.map.getContainer().querySelector("[mapboxgl-children]");e==null||e.remove(),R.savedMaps.push(this)}destroy(){this._map.remove()}redraw(){const t=this._map;!this._inRender&&t.style&&(t._frame&&(t._frame.cancel(),t._frame=null),t._render())}_createShadowTransform(t){const e=vt(t.transform);t.painter.transform=e,this._renderTransform=e}_updateSize(t){const{viewState:e}=t;if(e){const r=this._map;if(e.width!==r.transform.width||e.height!==r.transform.height)return r.resize(),!0}return!1}_updateViewState(t,e){if(this._internalUpdate)return!1;const r=this._map,o=this._renderTransform,{zoom:i,pitch:a,bearing:l}=o,s=r.isMoving();s&&(o.cameraElevationReference="sea");const c=G(o,{...q(r.transform),...t});if(s&&(o.cameraElevationReference="ground"),c&&e){const u=this._deferredEvents;u.move=!0,u.zoom||(u.zoom=i!==o.zoom),u.rotate||(u.rotate=l!==o.bearing),u.pitch||(u.pitch=a!==o.pitch)}return s||G(r.transform,t),c}_updateSettings(t,e){const r=this._map;let o=!1;for(const i of xt)i in t&&!C(t[i],e[i])&&(o=!0,r[`set${i[0].toUpperCase()}${i.slice(1)}`](t[i]));return o}_updateStyle(t,e){if(t.cursor!==e.cursor&&(this._map.getCanvas().style.cursor=t.cursor),t.mapStyle!==e.mapStyle){const r={diff:t.styleDiffing};return"localIdeographFontFamily"in t&&(r.localIdeographFontFamily=t.localIdeographFontFamily),this._map.setStyle(Q(t.mapStyle),r),!0}return!1}_updateStyleComponents(t,e){const r=this._map;let o=!1;return r.style.loaded()&&("light"in t&&!C(t.light,e.light)&&(o=!0,r.setLight(t.light)),"fog"in t&&!C(t.fog,e.fog)&&(o=!0,r.setFog(t.fog)),"terrain"in t&&!C(t.terrain,e.terrain)&&(!t.terrain||r.getSource(t.terrain.source))&&(o=!0,r.setTerrain(t.terrain))),o}_updateHandlers(t,e){const r=this._map;let o=!1;for(const i of Et){const a=t[i];C(a,e[i])||(o=!0,a?r[i].enable(a):r[i].disable())}return o}_queryRenderedFeatures(t){const e=this._map,{interactiveLayerIds:r=[]}=this.props;try{return e.queryRenderedFeatures(t,{layers:r.filter(e.getLayer.bind(e))})}catch{return[]}}_updateHover(t){var e;const{props:r}=this;if(r.interactiveLayerIds&&(r.onMouseMove||r.onMouseEnter||r.onMouseLeave)){const i=t.type,a=((e=this._hoveredFeatures)===null||e===void 0?void 0:e.length)>0,l=this._queryRenderedFeatures(t.point),s=l.length>0;!s&&a&&(t.type="mouseleave",this._onPointerEvent(t)),this._hoveredFeatures=l,s&&!a&&(t.type="mouseenter",this._onPointerEvent(t)),t.type=i}else this._hoveredFeatures=null}_fireEvent(t,e,r){const o=this._map,i=o.transform,a=typeof e=="string"?e:e.type;return a==="move"&&this._updateViewState(this.props,!1),a in I&&(typeof e=="object"&&(e.viewState=q(i)),this._map.isMoving())?(o.transform=this._renderTransform,t.call(o,e,r),o.transform=i,o):(t.call(o,e,r),o)}_onBeforeRepaint(){const t=this._map;this._internalUpdate=!0;for(const r in this._deferredEvents)this._deferredEvents[r]&&t.fire(r);this._internalUpdate=!1;const e=this._map.transform;this._map.transform=this._renderTransform,this._onAfterRepaint=()=>{this._map.transform=e}}}R.savedMaps=[];function Mt(){let n=null;if(typeof location<"u"){const t=/access_token=([^&\/]*)/.exec(location.search);n=t&&t[1]}try{n=n||{}.MapboxAccessToken}catch{}try{n=n||{}.REACT_APP_MAPBOX_ACCESS_TOKEN}catch{}return n}const Ct=["setMaxBounds","setMinZoom","setMaxZoom","setMinPitch","setMaxPitch","setRenderWorldCopies","setProjection","setStyle","addSource","removeSource","addLayer","removeLayer","setLayerZoomRange","setFilter","setPaintProperty","setLayoutProperty","setLight","setTerrain","setFog","remove"];function St(n,t){if(!n)return null;const e=n.map,r={getMap:()=>e,getCenter:()=>n.transform.center,getZoom:()=>n.transform.zoom,getBearing:()=>n.transform.bearing,getPitch:()=>n.transform.pitch,getPadding:()=>n.transform.padding,getBounds:()=>n.transform.getBounds(),project:o=>n.transform.locationPoint(t.LngLat.convert(o)),unproject:o=>n.transform.pointLocation(t.Point.convert(o)),queryTerrainElevation:(o,i)=>{const a=e.transform;e.transform=n.transform;const l=e.queryTerrainElevation(o,i);return e.transform=a,l}};for(const o of bt(e))!(o in r)&&!Ct.includes(o)&&(r[o]=e[o].bind(e));return r}function bt(n){const t=new Set;let e=n;for(;e;){for(const r of Object.getOwnPropertyNames(e))r[0]!=="_"&&typeof n[r]=="function"&&r!=="fire"&&r!=="setEventedParent"&&t.add(r);e=Object.getPrototypeOf(e)}return Array.from(t)}const Tt=typeof document<"u"?f.useLayoutEffect:f.useEffect,Lt=["baseApiUrl","maxParallelImageRequests","workerClass","workerCount","workerUrl"];function At(n,t){for(const e of Lt)e in t&&(n[e]=t[e]);t.RTLTextPlugin&&n.getRTLTextPluginStatus&&n.getRTLTextPluginStatus()==="unavailable"&&n.setRTLTextPlugin(t.RTLTextPlugin,e=>{e&&console.error(e)},!1)}const j=f.createContext(null),Rt={minZoom:0,maxZoom:22,minPitch:0,maxPitch:60,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,mapStyle:{version:8,sources:{},layers:[]},styleDiffing:!0,projection:"mercator",renderWorldCopies:!0,onError:n=>console.error(n.error),RTLTextPlugin:"https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-rtl-text/v0.2.3/mapbox-gl-rtl-text.js"},V=f.forwardRef((n,t)=>{const e=f.useContext(yt),[r,o]=f.useState(null),i=f.useRef(),{current:a}=f.useRef({mapLib:null,map:null});f.useEffect(()=>{const c=n.mapLib;let u=!0,d;return Promise.resolve(c||mt(()=>import("./mapbox-gl-30426aa1.js").then(h=>h.m),["assets/mapbox-gl-30426aa1.js","assets/index-77827b4c.js","assets/index-b8bd47ee.css"])).then(h=>{if(u){if(h.Map||(h=h.default),!h||!h.Map)throw new Error("Invalid mapLib");if(At(h,n),!h.supported||h.supported(n))n.reuseMaps&&(d=R.reuse(n,i.current)),d||(d=new R(h.Map,n,i.current)),a.map=St(d,h),a.mapLib=h,o(d),e==null||e.onMapMount(a.map,n.id);else throw new Error("Map is not supported by this browser")}}).catch(h=>{n.onError({type:"error",target:null,originalEvent:null,error:h})}),()=>{u=!1,d&&(e==null||e.onMapUnmount(n.id),n.reuseMaps?d.recycle():d.destroy())}},[]),Tt(()=>{r&&r.setProps(n)}),f.useImperativeHandle(t,()=>a.map,[r]);const l=f.useMemo(()=>({position:"relative",width:"100%",height:"100%",...n.style}),[n.style]),s={height:"100%"};return f.createElement("div",{id:n.id,ref:i,style:l},r&&f.createElement(j.Provider,{value:a},f.createElement("div",{"mapboxgl-children":"",style:s},n.children)))});V.displayName="Map";V.defaultProps=Rt;const Pt=/box|flex|grid|column|lineHeight|fontWeight|opacity|order|tabSize|zIndex/;function L(n,t){if(!n||!t)return;const e=n.style;for(const r in t){const o=t[r];Number.isFinite(o)&&!Pt.test(r)?e[r]=`${o}px`:e[r]=o}}const Nt={draggable:!1,popup:null,rotation:0,rotationAlignment:"auto",pitchAlignment:"auto"};function at(n){const{map:t,mapLib:e}=f.useContext(j),r=f.useRef({props:n});r.current.props=n;const o=f.useMemo(()=>{let i=!1;f.Children.forEach(n.children,s=>{s&&(i=!0)});const a={...n,element:i?document.createElement("div"):null},l=new e.Marker(a).setLngLat([n.longitude,n.latitude]);return l.getElement().addEventListener("click",s=>{var c,u;(u=(c=r.current.props).onClick)===null||u===void 0||u.call(c,{type:"click",target:l,originalEvent:s})}),l.on("dragstart",s=>{var c,u;const d=s;d.lngLat=o.getLngLat(),(u=(c=r.current.props).onDragStart)===null||u===void 0||u.call(c,d)}),l.on("drag",s=>{var c,u;const d=s;d.lngLat=o.getLngLat(),(u=(c=r.current.props).onDrag)===null||u===void 0||u.call(c,d)}),l.on("dragend",s=>{var c,u;const d=s;d.lngLat=o.getLngLat(),(u=(c=r.current.props).onDragEnd)===null||u===void 0||u.call(c,d)}),l},[]);return f.useEffect(()=>(o.addTo(t.getMap()),()=>{o.remove()}),[]),f.useEffect(()=>{L(o.getElement(),n.style)},[n.style]),(o.getLngLat().lng!==n.longitude||o.getLngLat().lat!==n.latitude)&&o.setLngLat([n.longitude,n.latitude]),n.offset&&!wt(o.getOffset(),n.offset)&&o.setOffset(n.offset),o.isDraggable()!==n.draggable&&o.setDraggable(n.draggable),o.getRotation()!==n.rotation&&o.setRotation(n.rotation),o.getRotationAlignment()!==n.rotationAlignment&&o.setRotationAlignment(n.rotationAlignment),o.getPitchAlignment()!==n.pitchAlignment&&o.setPitchAlignment(n.pitchAlignment),o.getPopup()!==n.popup&&o.setPopup(n.popup),st.createPortal(n.children,o.getElement())}at.defaultProps=Nt;const F=f.memo(at);function Y(n){return new Set(n?n.trim().split(/\s+/):[])}function Ot(n){const{map:t,mapLib:e}=f.useContext(j),r=f.useMemo(()=>document.createElement("div"),[]),o=f.useRef({props:n});o.current.props=n;const i=f.useMemo(()=>{const a={...n},l=new e.Popup(a).setLngLat([n.longitude,n.latitude]);return l.once("open",s=>{var c,u;(u=(c=o.current.props).onOpen)===null||u===void 0||u.call(c,s)}),l},[]);if(f.useEffect(()=>{const a=l=>{var s,c;(c=(s=o.current.props).onClose)===null||c===void 0||c.call(s,l)};return i.on("close",a),i.setDOMContent(r).addTo(t.getMap()),()=>{i.off("close",a),i.isOpen()&&i.remove()}},[]),f.useEffect(()=>{L(i.getElement(),n.style)},[n.style]),i.isOpen()&&((i.getLngLat().lng!==n.longitude||i.getLngLat().lat!==n.latitude)&&i.setLngLat([n.longitude,n.latitude]),n.offset&&!C(i.options.offset,n.offset)&&i.setOffset(n.offset),(i.options.anchor!==n.anchor||i.options.maxWidth!==n.maxWidth)&&(i.options.anchor=n.anchor,i.setMaxWidth(n.maxWidth)),i.options.className!==n.className)){const a=Y(i.options.className),l=Y(n.className);for(const s of a)l.has(s)||i.removeClassName(s);for(const s of l)a.has(s)||i.addClassName(s);i.options.className=n.className}return st.createPortal(n.children,r)}f.memo(Ot);function O(n,t,e,r){const o=f.useContext(j),i=f.useMemo(()=>n(o),[]);return f.useEffect(()=>{const a=r||e||t,l=typeof t=="function"&&typeof e=="function"?t:null,s=typeof e=="function"?e:typeof t=="function"?t:null,{map:c}=o;return c.hasControl(i)||(c.addControl(i,a==null?void 0:a.position),l&&l(o)),()=>{s&&s(o),c.hasControl(i)&&c.removeControl(i)}},[]),i}function zt(n){const t=O(({mapLib:e})=>new e.AttributionControl(n),{position:n.position});return f.useEffect(()=>{L(t._container,n.style)},[n.style]),null}f.memo(zt);function kt(n){const t=O(({mapLib:e})=>new e.FullscreenControl({container:n.containerId&&document.getElementById(n.containerId)}),{position:n.position});return f.useEffect(()=>{L(t._controlContainer,n.style)},[n.style]),null}f.memo(kt);const ct=f.forwardRef((n,t)=>{const e=f.useRef({props:n}),r=O(({mapLib:o})=>{const i=new o.GeolocateControl(n),a=i._setupUI;return i._setupUI=l=>{i._container.hasChildNodes()||a(l)},i.on("geolocate",l=>{var s,c;(c=(s=e.current.props).onGeolocate)===null||c===void 0||c.call(s,l)}),i.on("error",l=>{var s,c;(c=(s=e.current.props).onError)===null||c===void 0||c.call(s,l)}),i.on("outofmaxbounds",l=>{var s,c;(c=(s=e.current.props).onOutOfMaxBounds)===null||c===void 0||c.call(s,l)}),i.on("trackuserlocationstart",l=>{var s,c;(c=(s=e.current.props).onTrackUserLocationStart)===null||c===void 0||c.call(s,l)}),i.on("trackuserlocationend",l=>{var s,c;(c=(s=e.current.props).onTrackUserLocationEnd)===null||c===void 0||c.call(s,l)}),i},{position:n.position});return e.current.props=n,f.useImperativeHandle(t,()=>({trigger:()=>r.trigger()}),[]),f.useEffect(()=>{L(r._container,n.style)},[n.style]),null});ct.displayName="GeolocateControl";f.memo(ct);function jt(n){const t=O(({mapLib:e})=>new e.NavigationControl(n),{position:n.position});return f.useEffect(()=>{L(t._container,n.style)},[n.style]),null}f.memo(jt);const Ft={unit:"metric",maxWidth:100};function lt(n){const t=O(({mapLib:e})=>new e.ScaleControl(n),{position:n.position});return(t.options.unit!==n.unit||t.options.maxWidth!==n.maxWidth)&&(t.options.maxWidth=n.maxWidth,t.setUnit(n.unit)),f.useEffect(()=>{L(t._container,n.style)},[n.style]),null}lt.defaultProps=Ft;f.memo(lt);const Zt=({children:n,mapRef:t,onMoveEnd:e,onLoad:r})=>{const{isDarkMode:o}=pt(),i=`mapbox://styles/damianamodeo/${o?"clefix5la000901po4wflstdd":"clefifzvz000u01nw8h84n67m"}`;return _.jsx("div",{className:"h-full",children:_.jsx(V,{initialViewState:{latitude:-32.7316,longitude:151.5525,zoom:11},pitch:0,bearing:0,mapStyle:i,mapboxAccessToken:"pk.eyJ1IjoiZGFtaWFuYW1vZGVvIiwiYSI6ImNqeWxnb3lsejA4OXozYmxpajhzMXdvZjQifQ.OJBOK5ZvGEX2VaScbW_zUQ",ref:t,onMoveEnd:a=>{e(a)},style:{width:"100%",height:"100%"},children:n})})},It=({cluster:{id:n,properties:{point_count:t},geometry:{coordinates:[e,r]}},supercluster:o,mapRef:i,setViewport:a,viewport:l})=>_.jsx(F,{latitude:r,longitude:e,children:_.jsx("div",{className:`${t<5?"bg-blue-500 h-6 w-6":t<10?"bg-blue-500 h-7 w-7":t<20?"bg-blue-500 h-8 w-8 text-lg":t<35?"bg-blue-500 h-9 w-9 text-lg":t<50?"bg-blue-500 h-10 w-10 text-xl":t<100?"bg-blue-500 h-12 w-12 text-xl":t<200?"bg-blue-500 h-16 w-16 text-2xl":t<300?"bg-blue-500 h-20 w-20 text-2xl":t<400?"bg-blue-500 h-24 w-24 text-3xl":"bg-blue-500 h-28 w-28 text-4xl"}
                   grid place-items-center  rounded-full text-white`,onClick:s=>{var c;(c=i.current)==null||c.easeTo({center:[e,r],zoom:o==null?void 0:o.getClusterExpansionZoom(n),duration:500}),a({...l,zoom:o==null?void 0:o.getClusterExpansionZoom(n)})},children:t})},n),Ut=({cluster:{id:n,properties:{houseNumber:t,...e},geometry:{coordinates:[r,o]}},setAddress:i,setModalOpen:a})=>_.jsx(F,{latitude:o,longitude:r,children:_.jsx("button",{onClick:()=>{i({houseNumber:t,...e}),a(!0)},className:"bg-red-500 rounded-full w-6 h-6 text-lg-xx grid place-items-center",children:t})},n),Dt=({addresses:n,setAddress:t,setModalOpen:e})=>{const r=n.reduce((o,i)=>{const a=`id${String(i.geometry.coordinates[0])}${String(i.geometry.coordinates[1])}`;return o[a]||(o[a]=[]),o[a].push(i),o},[]);return Object.keys(r).map(o=>r[o].sort((i,a)=>String(i.properties.houseNumber*.001).toLowerCase().localeCompare(String(a.properties.c*.001).toLowerCase())).map((i,a)=>{const[l,s]=i.geometry.coordinates,{cluster:c,point_count:u,category:d,unitNumber:h,houseNumber:m}=i.properties,y=a+1;let g=Math.sqrt(y)-.8,p=4.6*g,v=Math.sqrt(y)+g/(y*.2),w=l+(v+p)*Math.cos(p)/15e4,x=s+(v+p)*Math.sin(p)/15e4;return w=Number(w.toFixed(6)),x=Number(x.toFixed(6)),_.jsx(F,{longitude:w,latitude:x,children:_.jsx("button",{onClick:()=>{t(i.properties),e(!0)},className:"bg-purple-500 rounded-full w-6 h-6 text-lg-xx grid place-items-center",children:m})},a)}))},Bt=({addresses:n,setAddress:t,setModalOpen:e})=>{const r=n.reduce((o,i)=>{const a=`id${String(i.geometry.coordinates[0])}${String(i.geometry.coordinates[1])}`;return o[a]||(o[a]=[]),o[a].push(i),o},[]);return Object.keys(r).map(o=>r[o].sort((i,a)=>String(i.properties.unitNumber*.001).toLowerCase().localeCompare(String(a.properties.unitNumber*.001).toLowerCase())).map((i,a)=>{const[l,s]=i.geometry.coordinates,{cluster:c,point_count:u,category:d,unitNumber:h,houseNumber:m,relevance:y}=i.properties,g=a+1;let p=Math.sqrt(g)-.8,v=4.6*p,w=Math.sqrt(g)+p/(g*.2),x=l+(w+v)*Math.cos(v)/15e4,A=s+(w+v)*Math.sin(v)/15e4;return x=Number(x.toFixed(6)),A=Number(A.toFixed(6)),_.jsx(F,{longitude:x,latitude:A,children:_.jsxs("button",{onClick:()=>{t(i.properties),e(!0)},className:`${y===1?"bg-orange-500":"bg-purple-500"}  px-1 text-lg-xx grid place-items-center`,children:[h,"/",m]})},a)}))},X=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],U=1,P=8;class H{static from(t){if(!(t instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[e,r]=new Uint8Array(t,0,2);if(e!==219)throw new Error("Data does not appear to be in a KDBush format.");const o=r>>4;if(o!==U)throw new Error(`Got v${o} data when expected v${U}.`);const i=X[r&15];if(!i)throw new Error("Unrecognized array type.");const[a]=new Uint16Array(t,2,1),[l]=new Uint32Array(t,4,1);return new H(l,a,i,t)}constructor(t,e=64,r=Float64Array,o){if(isNaN(t)||t<0)throw new Error(`Unpexpected numItems value: ${t}.`);this.numItems=+t,this.nodeSize=Math.min(Math.max(+e,2),65535),this.ArrayType=r,this.IndexArrayType=t<65536?Uint16Array:Uint32Array;const i=X.indexOf(this.ArrayType),a=t*2*this.ArrayType.BYTES_PER_ELEMENT,l=t*this.IndexArrayType.BYTES_PER_ELEMENT,s=(8-l%8)%8;if(i<0)throw new Error(`Unexpected typed array class: ${r}.`);o&&o instanceof ArrayBuffer?(this.data=o,this.ids=new this.IndexArrayType(this.data,P,t),this.coords=new this.ArrayType(this.data,P+l+s,t*2),this._pos=t*2,this._finished=!0):(this.data=new ArrayBuffer(P+a+l+s),this.ids=new this.IndexArrayType(this.data,P,t),this.coords=new this.ArrayType(this.data,P+l+s,t*2),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,(U<<4)+i]),new Uint16Array(this.data,2,1)[0]=e,new Uint32Array(this.data,4,1)[0]=t)}add(t,e){const r=this._pos>>1;return this.ids[r]=r,this.coords[this._pos++]=t,this.coords[this._pos++]=e,r}finish(){const t=this._pos>>1;if(t!==this.numItems)throw new Error(`Added ${t} items when expected ${this.numItems}.`);return $(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(t,e,r,o){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:i,coords:a,nodeSize:l}=this,s=[0,i.length-1,0],c=[];for(;s.length;){const u=s.pop()||0,d=s.pop()||0,h=s.pop()||0;if(d-h<=l){for(let p=h;p<=d;p++){const v=a[2*p],w=a[2*p+1];v>=t&&v<=r&&w>=e&&w<=o&&c.push(i[p])}continue}const m=h+d>>1,y=a[2*m],g=a[2*m+1];y>=t&&y<=r&&g>=e&&g<=o&&c.push(i[m]),(u===0?t<=y:e<=g)&&(s.push(h),s.push(m-1),s.push(1-u)),(u===0?r>=y:o>=g)&&(s.push(m+1),s.push(d),s.push(1-u))}return c}within(t,e,r){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:o,coords:i,nodeSize:a}=this,l=[0,o.length-1,0],s=[],c=r*r;for(;l.length;){const u=l.pop()||0,d=l.pop()||0,h=l.pop()||0;if(d-h<=a){for(let p=h;p<=d;p++)tt(i[2*p],i[2*p+1],t,e)<=c&&s.push(o[p]);continue}const m=h+d>>1,y=i[2*m],g=i[2*m+1];tt(y,g,t,e)<=c&&s.push(o[m]),(u===0?t-r<=y:e-r<=g)&&(l.push(h),l.push(m-1),l.push(1-u)),(u===0?t+r>=y:e+r>=g)&&(l.push(m+1),l.push(d),l.push(1-u))}return s}}function $(n,t,e,r,o,i){if(o-r<=e)return;const a=r+o>>1;ut(n,t,a,r,o,i),$(n,t,e,r,a-1,1-i),$(n,t,e,a+1,o,1-i)}function ut(n,t,e,r,o,i){for(;o>r;){if(o-r>600){const c=o-r+1,u=e-r+1,d=Math.log(c),h=.5*Math.exp(2*d/3),m=.5*Math.sqrt(d*h*(c-h)/c)*(u-c/2<0?-1:1),y=Math.max(r,Math.floor(e-u*h/c+m)),g=Math.min(o,Math.floor(e+(c-u)*h/c+m));ut(n,t,e,y,g,i)}const a=t[2*e+i];let l=r,s=o;for(N(n,t,r,e),t[2*o+i]>a&&N(n,t,r,o);l<s;){for(N(n,t,l,s),l++,s--;t[2*l+i]<a;)l++;for(;t[2*s+i]>a;)s--}t[2*r+i]===a?N(n,t,r,s):(s++,N(n,t,s,o)),s<=e&&(r=s+1),e<=s&&(o=s-1)}}function N(n,t,e,r){D(n,e,r),D(t,2*e,2*r),D(t,2*e+1,2*r+1)}function D(n,t,e){const r=n[t];n[t]=n[e],n[e]=r}function tt(n,t,e,r){const o=n-e,i=t-r;return o*o+i*i}const $t={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:n=>n},et=Math.fround||(n=>t=>(n[0]=+t,n[0]))(new Float32Array(1)),b=2,M=3,B=4,E=5,dt=6;class Vt{constructor(t){this.options=Object.assign(Object.create($t),t),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(t){const{log:e,minZoom:r,maxZoom:o}=this.options;e&&console.time("total time");const i=`prepare ${t.length} points`;e&&console.time(i),this.points=t;const a=[];for(let s=0;s<t.length;s++){const c=t[s];if(!c.geometry)continue;const[u,d]=c.geometry.coordinates,h=et(z(u)),m=et(k(d));a.push(h,m,1/0,s,-1,1),this.options.reduce&&a.push(0)}let l=this.trees[o+1]=this._createTree(a);e&&console.timeEnd(i);for(let s=o;s>=r;s--){const c=+Date.now();l=this.trees[s]=this._createTree(this._cluster(l,s)),e&&console.log("z%d: %d clusters in %dms",s,l.numItems,+Date.now()-c)}return e&&console.timeEnd("total time"),this}getClusters(t,e){let r=((t[0]+180)%360+360)%360-180;const o=Math.max(-90,Math.min(90,t[1]));let i=t[2]===180?180:((t[2]+180)%360+360)%360-180;const a=Math.max(-90,Math.min(90,t[3]));if(t[2]-t[0]>=360)r=-180,i=180;else if(r>i){const d=this.getClusters([r,o,180,a],e),h=this.getClusters([-180,o,i,a],e);return d.concat(h)}const l=this.trees[this._limitZoom(e)],s=l.range(z(r),k(a),z(i),k(o)),c=l.data,u=[];for(const d of s){const h=this.stride*d;u.push(c[h+E]>1?nt(c,h,this.clusterProps):this.points[c[h+M]])}return u}getChildren(t){const e=this._getOriginId(t),r=this._getOriginZoom(t),o="No cluster with the specified id.",i=this.trees[r];if(!i)throw new Error(o);const a=i.data;if(e*this.stride>=a.length)throw new Error(o);const l=this.options.radius/(this.options.extent*Math.pow(2,r-1)),s=a[e*this.stride],c=a[e*this.stride+1],u=i.within(s,c,l),d=[];for(const h of u){const m=h*this.stride;a[m+B]===t&&d.push(a[m+E]>1?nt(a,m,this.clusterProps):this.points[a[m+M]])}if(d.length===0)throw new Error(o);return d}getLeaves(t,e,r){e=e||10,r=r||0;const o=[];return this._appendLeaves(o,t,e,r,0),o}getTile(t,e,r){const o=this.trees[this._limitZoom(t)],i=Math.pow(2,t),{extent:a,radius:l}=this.options,s=l/a,c=(r-s)/i,u=(r+1+s)/i,d={features:[]};return this._addTileFeatures(o.range((e-s)/i,c,(e+1+s)/i,u),o.data,e,r,i,d),e===0&&this._addTileFeatures(o.range(1-s/i,c,1,u),o.data,i,r,i,d),e===i-1&&this._addTileFeatures(o.range(0,c,s/i,u),o.data,-1,r,i,d),d.features.length?d:null}getClusterExpansionZoom(t){let e=this._getOriginZoom(t)-1;for(;e<=this.options.maxZoom;){const r=this.getChildren(t);if(e++,r.length!==1)break;t=r[0].properties.cluster_id}return e}_appendLeaves(t,e,r,o,i){const a=this.getChildren(e);for(const l of a){const s=l.properties;if(s&&s.cluster?i+s.point_count<=o?i+=s.point_count:i=this._appendLeaves(t,s.cluster_id,r,o,i):i<o?i++:t.push(l),t.length===r)break}return i}_createTree(t){const e=new H(t.length/this.stride|0,this.options.nodeSize,Float32Array);for(let r=0;r<t.length;r+=this.stride)e.add(t[r],t[r+1]);return e.finish(),e.data=t,e}_addTileFeatures(t,e,r,o,i,a){for(const l of t){const s=l*this.stride,c=e[s+E]>1;let u,d,h;if(c)u=ft(e,s,this.clusterProps),d=e[s],h=e[s+1];else{const g=this.points[e[s+M]];u=g.properties;const[p,v]=g.geometry.coordinates;d=z(p),h=k(v)}const m={type:1,geometry:[[Math.round(this.options.extent*(d*i-r)),Math.round(this.options.extent*(h*i-o))]],tags:u};let y;c||this.options.generateId?y=e[s+M]:y=this.points[e[s+M]].id,y!==void 0&&(m.id=y),a.features.push(m)}}_limitZoom(t){return Math.max(this.options.minZoom,Math.min(Math.floor(+t),this.options.maxZoom+1))}_cluster(t,e){const{radius:r,extent:o,reduce:i,minPoints:a}=this.options,l=r/(o*Math.pow(2,e)),s=t.data,c=[],u=this.stride;for(let d=0;d<s.length;d+=u){if(s[d+b]<=e)continue;s[d+b]=e;const h=s[d],m=s[d+1],y=t.within(s[d],s[d+1],l),g=s[d+E];let p=g;for(const v of y){const w=v*u;s[w+b]>e&&(p+=s[w+E])}if(p>g&&p>=a){let v=h*g,w=m*g,x,A=-1;const Z=((d/u|0)<<5)+(e+1)+this.points.length;for(const ht of y){const S=ht*u;if(s[S+b]<=e)continue;s[S+b]=e;const W=s[S+E];v+=s[S]*W,w+=s[S+1]*W,s[S+B]=Z,i&&(x||(x=this._map(s,d,!0),A=this.clusterProps.length,this.clusterProps.push(x)),i(x,this._map(s,S)))}s[d+B]=Z,c.push(v/p,w/p,1/0,Z,-1,p),i&&c.push(A)}else{for(let v=0;v<u;v++)c.push(s[d+v]);if(p>1)for(const v of y){const w=v*u;if(!(s[w+b]<=e)){s[w+b]=e;for(let x=0;x<u;x++)c.push(s[w+x])}}}}return c}_getOriginId(t){return t-this.points.length>>5}_getOriginZoom(t){return(t-this.points.length)%32}_map(t,e,r){if(t[e+E]>1){const a=this.clusterProps[t[e+dt]];return r?Object.assign({},a):a}const o=this.points[t[e+M]].properties,i=this.options.map(o);return r&&i===o?Object.assign({},i):i}}function nt(n,t,e){return{type:"Feature",id:n[t+M],properties:ft(n,t,e),geometry:{type:"Point",coordinates:[Ht(n[t]),Wt(n[t+1])]}}}function ft(n,t,e){const r=n[t+E],o=r>=1e4?`${Math.round(r/1e3)}k`:r>=1e3?`${Math.round(r/100)/10}k`:r,i=n[t+dt],a=i===-1?{}:Object.assign({},e[i]);return Object.assign(a,{cluster:!0,cluster_id:n[t+M],point_count:r,point_count_abbreviated:o})}function z(n){return n/360+.5}function k(n){const t=Math.sin(n*Math.PI/180),e=.5-.25*Math.log((1+t)/(1-t))/Math.PI;return e<0?0:e>1?1:e}function Ht(n){return(n-.5)*360}function Wt(n){const t=(180-n*360)*Math.PI/180;return 360*Math.atan(Math.exp(t))/Math.PI-90}var ot=Object.prototype.hasOwnProperty;function rt(n,t,e){for(e of n.keys())if(T(e,t))return e}function T(n,t){var e,r,o;if(n===t)return!0;if(n&&t&&(e=n.constructor)===t.constructor){if(e===Date)return n.getTime()===t.getTime();if(e===RegExp)return n.toString()===t.toString();if(e===Array){if((r=n.length)===t.length)for(;r--&&T(n[r],t[r]););return r===-1}if(e===Set){if(n.size!==t.size)return!1;for(r of n)if(o=r,o&&typeof o=="object"&&(o=rt(t,o),!o)||!t.has(o))return!1;return!0}if(e===Map){if(n.size!==t.size)return!1;for(r of n)if(o=r[0],o&&typeof o=="object"&&(o=rt(t,o),!o)||!T(r[1],t.get(o)))return!1;return!0}if(e===ArrayBuffer)n=new Uint8Array(n),t=new Uint8Array(t);else if(e===DataView){if((r=n.byteLength)===t.byteLength)for(;r--&&n.getInt8(r)===t.getInt8(r););return r===-1}if(ArrayBuffer.isView(n)){if((r=n.byteLength)===t.byteLength)for(;r--&&n[r]===t[r];);return r===-1}if(!e||typeof n=="object"){r=0;for(e in n)if(ot.call(n,e)&&++r&&!ot.call(t,e)||!(e in t)||!T(n[e],t[e]))return!1;return Object.keys(t).length===r}}return n!==n&&t!==t}function qt(n){var t=f.useRef(n),e=f.useRef(0);return T(n,t.current)||(t.current=n,e.current+=1),f.useMemo(function(){return t.current},[e.current])}function Gt(n,t){return f.useEffect(n,qt(t))}var Qt=function(t){var e=t.points,r=t.bounds,o=t.zoom,i=t.options,a=f.useRef(),l=f.useRef(),s=f.useState([]),c=s[0],u=s[1],d=Math.round(o);return Gt(function(){(!a.current||!T(l.current,e)||!T(a.current.options,i))&&(a.current=new Vt(i),a.current.load(e)),r&&u(a.current.getClusters(r,d)),l.current=e},[e,r,d,i]),{clusters:c,supercluster:a.current}};const Jt=({notAtHomesList:n,mapRef:t,viewport:e,setViewport:r,setAddress:o,setModalOpen:i})=>{const a=n.filter(m=>m.lat!==void 0).filter(m=>m.letter!==!0).map(m=>({type:"Feature",properties:{cluster:!1,...m},geometry:{type:"Point",coordinates:[m.lng,m.lat]}})),l={radius:80,maxZoom:14},s=t.current?t.current.getMap().getBounds().toArray().flat():null,{clusters:c,supercluster:u}=Qt({points:a,bounds:s,zoom:e.zoom,options:l});let d=[],h=[];return _.jsxs(_.Fragment,{children:[c.map(m=>{const{cluster:y,unitNumber:g}=m.properties;if(y)return _.jsx(It,{cluster:m,supercluster:u,mapRef:t,setViewport:r,viewport:e});if(m.properties.relevance<1){h.push(m);return}if(g!==""&&typeof parseInt(g)=="number"){d.push(m);return}return _.jsx(Ut,{cluster:m,setAddress:o,setModalOpen:i})}),Dt({addresses:h,setAddress:o,setModalOpen:i}),Bt({addresses:d,setAddress:o,setModalOpen:i})]})},it=({children:n,notAtHomesList:t})=>{const[e,r]=f.useState(void 0),[o,i]=f.useState(!1),a=f.useRef(null),[l,s]=f.useState({latitude:52.6376,longitude:-1.135171,width:"100vw",height:"100vh",zoom:12});return f.useEffect(()=>(s(l),()=>{}),[t]),_.jsxs("div",{className:"h-full",children:[_.jsx(gt,{address:e,isOpen:o,setModalOpen:i}),_.jsx(Zt,{mapRef:a,onMoveEnd:()=>s({...l,zoom:a.current?a.current.getZoom():null}),children:_.jsx(Jt,{notAtHomesList:t,mapRef:a,viewport:l,setViewport:s,setAddress:r,setModalOpen:i})})]})},re=({children:n,notAtHomesList:t})=>{f.useState(t);const[e,r]=f.useState(_.jsx("div",{className:"grid place-items-center h-full dark:text-white",children:"LOADING..."})),[o,i]=f.useState(!0);return f.useEffect(()=>{if(o){const a=setTimeout(()=>{r(_.jsx(it,{notAtHomesList:t}))},310);return i(!1),()=>clearTimeout(a)}else r(_.jsx(it,{notAtHomesList:t}))},[t]),_.jsx(_.Fragment,{children:e})};export{re as default};
