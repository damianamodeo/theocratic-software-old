import{r as s,R as H}from"./index-32577dac.js";import{s as te,l as C,o as f,S as W,D as F,y as k,u as w,p as j,c as he,d as z,R as Re,X as A,I as G,C as Oe,e as Se,a as m,r as ye,b as q}from"./transition-66f54cb3.js";import{H as Le,h as Ie,T as De,c as Te,p as $e,I as Pe}from"./hidden-0f718e00.js";import{s as we}from"./upDownArrow-0cea9ba2.js";function re(e,n){let[r,o]=s.useState(e),i=te(e);return C(()=>o(i.current),[i,o,...n]),r}function Ee(e){throw new Error("Unexpected object: "+e)}var y=(e=>(e[e.First=0]="First",e[e.Previous=1]="Previous",e[e.Next=2]="Next",e[e.Last=3]="Last",e[e.Specific=4]="Specific",e[e.Nothing=5]="Nothing",e))(y||{});function Ce(e,n){let r=n.resolveItems();if(r.length<=0)return null;let o=n.resolveActiveIndex(),i=o??-1,a=(()=>{switch(e.focus){case 0:return r.findIndex(t=>!n.resolveDisabled(t));case 1:{let t=r.slice().reverse().findIndex((l,p,b)=>i!==-1&&b.length-p-1>=i?!1:!n.resolveDisabled(l));return t===-1?t:r.length-1-t}case 2:return r.findIndex((t,l)=>l<=i?!1:!n.resolveDisabled(t));case 3:{let t=r.slice().reverse().findIndex(l=>!n.resolveDisabled(l));return t===-1?t:r.length-1-t}case 4:return r.findIndex(t=>n.resolveId(t)===e.id);case 5:return null;default:Ee(e)}})();return a===-1?o:a}function ne(e={},n=null,r=[]){for(let[o,i]of Object.entries(e))ie(r,oe(n,o),i);return r}function oe(e,n){return e?e+"["+n+"]":n}function ie(e,n,r){if(Array.isArray(r))for(let[o,i]of r.entries())ie(e,oe(n,o.toString()),i);else r instanceof Date?e.push([n,r.toISOString()]):typeof r=="boolean"?e.push([n,r?"1":"0"]):typeof r=="string"?e.push([n,r]):typeof r=="number"?e.push([n,`${r}`]):r==null?e.push([n,""]):ne(r,n,e)}function Fe(e,n,r){let[o,i]=s.useState(r),a=e!==void 0,t=s.useRef(a),l=s.useRef(!1),p=s.useRef(!1);return a&&!t.current&&!l.current?(l.current=!0,t.current=a,console.error("A component is changing from uncontrolled to controlled. This may be caused by the value changing from undefined to a defined value, which should not happen.")):!a&&t.current&&!p.current&&(p.current=!0,t.current=a,console.error("A component is changing from controlled to uncontrolled. This may be caused by the value changing from a defined value to undefined, which should not happen.")),[a?e:o,f(b=>(a||i(b),n==null?void 0:n(b)))]}function Z(e){return[e.screenX,e.screenY]}function ke(){let e=s.useRef([-1,-1]);return{wasMoved(n){let r=Z(n);return e.current[0]===r[0]&&e.current[1]===r[1]?!1:(e.current=r,!0)},update(n){e.current=Z(n)}}}let _=/([\u2700-\u27BF]|[\uE000-\uF8FF]|\uD83C[\uDC00-\uDFFF]|\uD83D[\uDC00-\uDFFF]|[\u2011-\u26FF]|\uD83E[\uDD10-\uDDFF])/g;function ee(e){var n,r;let o=(n=e.innerText)!=null?n:"",i=e.cloneNode(!0);if(!(i instanceof HTMLElement))return o;let a=!1;for(let l of i.querySelectorAll('[hidden],[aria-hidden],[role="img"]'))l.remove(),a=!0;let t=a?(r=i.innerText)!=null?r:"":o;return _.test(t)&&(t=t.replace(_,"")),t}function Ae(e){let n=e.getAttribute("aria-label");if(typeof n=="string")return n.trim();let r=e.getAttribute("aria-labelledby");if(r){let o=r.split(" ").map(i=>{let a=document.getElementById(i);if(a){let t=a.getAttribute("aria-label");return typeof t=="string"?t.trim():ee(a).trim()}return null}).filter(Boolean);if(o.length>0)return o.join(", ")}return ee(e).trim()}function Me(e){let n=s.useRef(""),r=s.useRef("");return f(()=>{let o=e.current;if(!o)return"";let i=o.innerText;if(n.current===i)return r.current;let a=Ae(o).trim().toLowerCase();return n.current=i,r.current=a,a})}var Ne=(e=>(e[e.Open=0]="Open",e[e.Closed=1]="Closed",e))(Ne||{}),Qe=(e=>(e[e.Single=0]="Single",e[e.Multi=1]="Multi",e))(Qe||{}),Be=(e=>(e[e.Pointer=0]="Pointer",e[e.Other=1]="Other",e))(Be||{}),Ue=(e=>(e[e.OpenListbox=0]="OpenListbox",e[e.CloseListbox=1]="CloseListbox",e[e.GoToOption=2]="GoToOption",e[e.Search=3]="Search",e[e.ClearSearch=4]="ClearSearch",e[e.RegisterOption=5]="RegisterOption",e[e.UnregisterOption=6]="UnregisterOption",e[e.RegisterLabel=7]="RegisterLabel",e))(Ue||{});function X(e,n=r=>r){let r=e.activeOptionIndex!==null?e.options[e.activeOptionIndex]:null,o=Pe(n(e.options.slice()),a=>a.dataRef.current.domRef.current),i=r?o.indexOf(r):null;return i===-1&&(i=null),{options:o,activeOptionIndex:i}}let He={[1](e){return e.dataRef.current.disabled||e.listboxState===1?e:{...e,activeOptionIndex:null,listboxState:1}},[0](e){if(e.dataRef.current.disabled||e.listboxState===0)return e;let n=e.activeOptionIndex,{isSelected:r}=e.dataRef.current,o=e.options.findIndex(i=>r(i.dataRef.current.value));return o!==-1&&(n=o),{...e,listboxState:0,activeOptionIndex:n}},[2](e,n){var r;if(e.dataRef.current.disabled||e.listboxState===1)return e;let o=X(e),i=Ce(n,{resolveItems:()=>o.options,resolveActiveIndex:()=>o.activeOptionIndex,resolveId:a=>a.id,resolveDisabled:a=>a.dataRef.current.disabled});return{...e,...o,searchQuery:"",activeOptionIndex:i,activationTrigger:(r=n.trigger)!=null?r:1}},[3]:(e,n)=>{if(e.dataRef.current.disabled||e.listboxState===1)return e;let r=e.searchQuery!==""?0:1,o=e.searchQuery+n.value.toLowerCase(),i=(e.activeOptionIndex!==null?e.options.slice(e.activeOptionIndex+r).concat(e.options.slice(0,e.activeOptionIndex+r)):e.options).find(t=>{var l;return!t.dataRef.current.disabled&&((l=t.dataRef.current.textValue)==null?void 0:l.startsWith(o))}),a=i?e.options.indexOf(i):-1;return a===-1||a===e.activeOptionIndex?{...e,searchQuery:o}:{...e,searchQuery:o,activeOptionIndex:a,activationTrigger:1}},[4](e){return e.dataRef.current.disabled||e.listboxState===1||e.searchQuery===""?e:{...e,searchQuery:""}},[5]:(e,n)=>{let r={id:n.id,dataRef:n.dataRef},o=X(e,i=>[...i,r]);return e.activeOptionIndex===null&&e.dataRef.current.isSelected(n.dataRef.current.value)&&(o.activeOptionIndex=o.options.indexOf(r)),{...e,...o}},[6]:(e,n)=>{let r=X(e,o=>{let i=o.findIndex(a=>a.id===n.id);return i!==-1&&o.splice(i,1),o});return{...e,...r,activationTrigger:1}},[7]:(e,n)=>({...e,labelId:n.id})},K=s.createContext(null);K.displayName="ListboxActionsContext";function M(e){let n=s.useContext(K);if(n===null){let r=new Error(`<${e} /> is missing a parent <Listbox /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(r,M),r}return n}let Y=s.createContext(null);Y.displayName="ListboxDataContext";function N(e){let n=s.useContext(Y);if(n===null){let r=new Error(`<${e} /> is missing a parent <Listbox /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(r,N),r}return n}function je(e,n){return w(n.type,He,e,n)}let ze=s.Fragment;function Ge(e,n){let{value:r,defaultValue:o,form:i,name:a,onChange:t,by:l=(c,d)=>c===d,disabled:p=!1,horizontal:b=!1,multiple:h=!1,...L}=e;const $=b?"horizontal":"vertical";let D=k(n),[R=h?[]:void 0,I]=Fe(r,t,o),[g,u]=s.useReducer(je,{dataRef:s.createRef(),listboxState:1,options:[],searchQuery:"",labelId:null,activeOptionIndex:null,activationTrigger:1}),v=s.useRef({static:!1,hold:!1}),P=s.useRef(null),Q=s.useRef(null),V=s.useRef(null),O=f(typeof l=="string"?(c,d)=>{let S=l;return(c==null?void 0:c[S])===(d==null?void 0:d[S])}:l),T=s.useCallback(c=>w(x.mode,{[1]:()=>R.some(d=>O(d,c)),[0]:()=>O(R,c)}),[R]),x=s.useMemo(()=>({...g,value:R,disabled:p,mode:h?1:0,orientation:$,compare:O,isSelected:T,optionsPropsRef:v,labelRef:P,buttonRef:Q,optionsRef:V}),[R,p,h,g]);C(()=>{g.dataRef.current=x},[x]),Le([x.buttonRef,x.optionsRef],(c,d)=>{var S;u({type:1}),Ie(d,De.Loose)||(c.preventDefault(),(S=x.buttonRef.current)==null||S.focus())},x.listboxState===0);let ae=s.useMemo(()=>({open:x.listboxState===0,disabled:p,value:R}),[x,p,R]),le=f(c=>{let d=x.options.find(S=>S.id===c);d&&E(d.dataRef.current.value)}),ue=f(()=>{if(x.activeOptionIndex!==null){let{dataRef:c,id:d}=x.options[x.activeOptionIndex];E(c.current.value),u({type:2,focus:y.Specific,id:d})}}),se=f(()=>u({type:0})),ce=f(()=>u({type:1})),de=f((c,d,S)=>c===y.Specific?u({type:2,focus:y.Specific,id:d,trigger:S}):u({type:2,focus:c,trigger:S})),pe=f((c,d)=>(u({type:5,id:c,dataRef:d}),()=>u({type:6,id:c}))),fe=f(c=>(u({type:7,id:c}),()=>u({type:7,id:null}))),E=f(c=>w(x.mode,{[0](){return I==null?void 0:I(c)},[1](){let d=x.value.slice(),S=d.findIndex(U=>O(U,c));return S===-1?d.push(c):d.splice(S,1),I==null?void 0:I(d)}})),be=f(c=>u({type:3,value:c})),ve=f(()=>u({type:4})),xe=s.useMemo(()=>({onChange:E,registerOption:pe,registerLabel:fe,goToOption:de,closeListbox:ce,openListbox:se,selectActiveOption:ue,selectOption:le,search:be,clearSearch:ve}),[]),ge={ref:D},B=s.useRef(null),me=j();return s.useEffect(()=>{B.current&&o!==void 0&&me.addEventListener(B.current,"reset",()=>{E(o)})},[B,E]),H.createElement(K.Provider,{value:xe},H.createElement(Y.Provider,{value:x},H.createElement(he,{value:w(x.listboxState,{[0]:z.Open,[1]:z.Closed})},a!=null&&R!=null&&ne({[a]:R}).map(([c,d],S)=>H.createElement(Te,{features:$e.Hidden,ref:S===0?U=>{var J;B.current=(J=U==null?void 0:U.closest("form"))!=null?J:null}:void 0,...Re({key:c,as:"input",type:"hidden",hidden:!0,readOnly:!0,form:i,name:c,value:d})})),A({ourProps:ge,theirProps:L,slot:ae,defaultTag:ze,name:"Listbox"}))))}let Ve="button";function Xe(e,n){var r;let o=G(),{id:i=`headlessui-listbox-button-${o}`,...a}=e,t=N("Listbox.Button"),l=M("Listbox.Button"),p=k(t.buttonRef,n),b=j(),h=f(g=>{switch(g.key){case m.Space:case m.Enter:case m.ArrowDown:g.preventDefault(),l.openListbox(),b.nextFrame(()=>{t.value||l.goToOption(y.First)});break;case m.ArrowUp:g.preventDefault(),l.openListbox(),b.nextFrame(()=>{t.value||l.goToOption(y.Last)});break}}),L=f(g=>{switch(g.key){case m.Space:g.preventDefault();break}}),$=f(g=>{if(ye(g.currentTarget))return g.preventDefault();t.listboxState===0?(l.closeListbox(),b.nextFrame(()=>{var u;return(u=t.buttonRef.current)==null?void 0:u.focus({preventScroll:!0})})):(g.preventDefault(),l.openListbox())}),D=re(()=>{if(t.labelId)return[t.labelId,i].join(" ")},[t.labelId,i]),R=s.useMemo(()=>({open:t.listboxState===0,disabled:t.disabled,value:t.value}),[t]),I={ref:p,id:i,type:we(e,t.buttonRef),"aria-haspopup":"listbox","aria-controls":(r=t.optionsRef.current)==null?void 0:r.id,"aria-expanded":t.disabled?void 0:t.listboxState===0,"aria-labelledby":D,disabled:t.disabled,onKeyDown:h,onKeyUp:L,onClick:$};return A({ourProps:I,theirProps:a,slot:R,defaultTag:Ve,name:"Listbox.Button"})}let qe="label";function Ke(e,n){let r=G(),{id:o=`headlessui-listbox-label-${r}`,...i}=e,a=N("Listbox.Label"),t=M("Listbox.Label"),l=k(a.labelRef,n);C(()=>t.registerLabel(o),[o]);let p=f(()=>{var h;return(h=a.buttonRef.current)==null?void 0:h.focus({preventScroll:!0})}),b=s.useMemo(()=>({open:a.listboxState===0,disabled:a.disabled}),[a]);return A({ourProps:{ref:l,id:o,onClick:p},theirProps:i,slot:b,defaultTag:qe,name:"Listbox.Label"})}let Ye="ul",Je=W.RenderStrategy|W.Static;function We(e,n){var r;let o=G(),{id:i=`headlessui-listbox-options-${o}`,...a}=e,t=N("Listbox.Options"),l=M("Listbox.Options"),p=k(t.optionsRef,n),b=j(),h=j(),L=Oe(),$=(()=>L!==null?(L&z.Open)===z.Open:t.listboxState===0)();s.useEffect(()=>{var u;let v=t.optionsRef.current;v&&t.listboxState===0&&v!==((u=Se(v))==null?void 0:u.activeElement)&&v.focus({preventScroll:!0})},[t.listboxState,t.optionsRef]);let D=f(u=>{switch(h.dispose(),u.key){case m.Space:if(t.searchQuery!=="")return u.preventDefault(),u.stopPropagation(),l.search(u.key);case m.Enter:if(u.preventDefault(),u.stopPropagation(),t.activeOptionIndex!==null){let{dataRef:v}=t.options[t.activeOptionIndex];l.onChange(v.current.value)}t.mode===0&&(l.closeListbox(),q().nextFrame(()=>{var v;return(v=t.buttonRef.current)==null?void 0:v.focus({preventScroll:!0})}));break;case w(t.orientation,{vertical:m.ArrowDown,horizontal:m.ArrowRight}):return u.preventDefault(),u.stopPropagation(),l.goToOption(y.Next);case w(t.orientation,{vertical:m.ArrowUp,horizontal:m.ArrowLeft}):return u.preventDefault(),u.stopPropagation(),l.goToOption(y.Previous);case m.Home:case m.PageUp:return u.preventDefault(),u.stopPropagation(),l.goToOption(y.First);case m.End:case m.PageDown:return u.preventDefault(),u.stopPropagation(),l.goToOption(y.Last);case m.Escape:return u.preventDefault(),u.stopPropagation(),l.closeListbox(),b.nextFrame(()=>{var v;return(v=t.buttonRef.current)==null?void 0:v.focus({preventScroll:!0})});case m.Tab:u.preventDefault(),u.stopPropagation();break;default:u.key.length===1&&(l.search(u.key),h.setTimeout(()=>l.clearSearch(),350));break}}),R=re(()=>{var u,v,P;return(P=(u=t.labelRef.current)==null?void 0:u.id)!=null?P:(v=t.buttonRef.current)==null?void 0:v.id},[t.labelRef.current,t.buttonRef.current]),I=s.useMemo(()=>({open:t.listboxState===0}),[t]),g={"aria-activedescendant":t.activeOptionIndex===null||(r=t.options[t.activeOptionIndex])==null?void 0:r.id,"aria-multiselectable":t.mode===1?!0:void 0,"aria-labelledby":R,"aria-orientation":t.orientation,id:i,onKeyDown:D,role:"listbox",tabIndex:0,ref:p};return A({ourProps:g,theirProps:a,slot:I,defaultTag:Ye,features:Je,visible:$,name:"Listbox.Options"})}let Ze="li";function _e(e,n){let r=G(),{id:o=`headlessui-listbox-option-${r}`,disabled:i=!1,value:a,...t}=e,l=N("Listbox.Option"),p=M("Listbox.Option"),b=l.activeOptionIndex!==null?l.options[l.activeOptionIndex].id===o:!1,h=l.isSelected(a),L=s.useRef(null),$=Me(L),D=te({disabled:i,value:a,domRef:L,get textValue(){return $()}}),R=k(n,L);C(()=>{if(l.listboxState!==0||!b||l.activationTrigger===0)return;let O=q();return O.requestAnimationFrame(()=>{var T,x;(x=(T=L.current)==null?void 0:T.scrollIntoView)==null||x.call(T,{block:"nearest"})}),O.dispose},[L,b,l.listboxState,l.activationTrigger,l.activeOptionIndex]),C(()=>p.registerOption(o,D),[D,o]);let I=f(O=>{if(i)return O.preventDefault();p.onChange(a),l.mode===0&&(p.closeListbox(),q().nextFrame(()=>{var T;return(T=l.buttonRef.current)==null?void 0:T.focus({preventScroll:!0})}))}),g=f(()=>{if(i)return p.goToOption(y.Nothing);p.goToOption(y.Specific,o)}),u=ke(),v=f(O=>u.update(O)),P=f(O=>{u.wasMoved(O)&&(i||b||p.goToOption(y.Specific,o,0))}),Q=f(O=>{u.wasMoved(O)&&(i||b&&p.goToOption(y.Nothing))}),V=s.useMemo(()=>({active:b,selected:h,disabled:i}),[b,h,i]);return A({ourProps:{id:o,ref:R,role:"option",tabIndex:i===!0?void 0:-1,"aria-disabled":i===!0?!0:void 0,"aria-selected":h,disabled:void 0,onClick:I,onFocus:g,onPointerEnter:v,onMouseEnter:v,onPointerMove:P,onMouseMove:P,onPointerLeave:Q,onMouseLeave:Q},theirProps:t,slot:V,defaultTag:Ze,name:"Listbox.Option"})}let et=F(Ge),tt=F(Xe),rt=F(Ke),nt=F(We),ot=F(_e),st=Object.assign(et,{Button:tt,Label:rt,Options:nt,Option:ot});export{st as N,Fe as T,y as a,ne as e,re as i,ke as u,Ce as x};
