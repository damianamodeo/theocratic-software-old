import{j as p,r as f,_ as wt,a as ut,u as bt}from"./index-c712c176.js";import{M as Et,B as $,T as Mt}from"./Modal-b869a230.js";import{r as dt,f as G,b as Ct,d as St,c as At}from"./deleteNotAtHome-63823a81.js";import{A as Z}from"./Disclosure-76960544.js";import"./transition-a3f84885.js";import"./upDownArrow-add46327.js";const Tt=async(n,t,e)=>{const o=dt(G,"notAtHomes","MaitlandCongregation");try{return await Ct(G,async s=>{const c=await s.get(o).then(l=>l.data());s.update(o,{...c,[n.key]:{...c[n.key],[t]:e}})})}catch(r){return console.error(r.message),r}},ht=({isOpen:n,address:t,setModalOpen:e})=>p.jsxs(Et,{isOpen:n,onClose:()=>{},title:"",height:"md",children:[p.jsxs("div",{className:"h-full text-center text-xl dark:text-white",children:[(t==null?void 0:t.unitNumber)&&`${t==null?void 0:t.unitNumber}/`,t==null?void 0:t.houseNumber," ",t==null?void 0:t.street,", ",t==null?void 0:t.suburb]}),p.jsxs("div",{className:"grid place-items-center gap-4",children:[p.jsx($,{width:"md",clickAction:()=>e(!1),color:"blue",children:"cancel"}),p.jsx($,{width:"md",clickAction:()=>{Tt(t,"letter",!0),e(!1)},color:"blue",children:"Letter List"}),p.jsx($,{width:"md",clickAction:()=>{St(t),e(!1)},color:"blue",children:"Delete"})]})]}),Nt=({suburbs:n})=>{const[t,e]=f.useState(void 0),[o,r]=f.useState(!1);return p.jsxs("div",{className:"",children:[p.jsx(ht,{address:t,isOpen:o,setModalOpen:r}),n.filter(s=>s.suburb!==void 0).sort((s,c)=>c.total-s.total).map((s,c)=>p.jsx("div",{className:"mx-auto w-full max-w-md p-2",children:p.jsx(Z,{title:p.jsxs("div",{className:"p-3 text-2xl",children:[`${s.suburb} (${s.total})`," "]}),children:s.streets.sort((l,i)=>l.street.localeCompare(i.street)).map((l,i)=>p.jsx("div",{className:"my-2 mx-6",children:p.jsx(Z,{title:p.jsx("div",{className:"p-2 w-full bg-neutral-200 dark:bg-neutral-700 rounded",children:`${l.street} ${l.addresses.length}`}),children:p.jsx("div",{className:" grid grid-cols-[repeat(auto-fill,minmax(3.5rem,1fr))]",children:l.addresses.sort((a,d)=>a.houseNumber-d.houseNumber).map((a,d)=>p.jsx("div",{children:p.jsxs("div",{onClick:()=>{e(a),r(!0)},className:`m-1 py-2 rounded text-center dark:text-white ${a.houseNumber%2===0?"dark:bg-neutral-600 bg-neutral-300":"dark:bg-neutral-800 bg-neutral-400"}`,children:[a.unitNumber&&`${a.unitNumber}/`,a.houseNumber]})},d))})},i)},i))})},c))]})},Lt=({mapNumbers:n})=>{const[t,e]=f.useState(void 0),[o,r]=f.useState(!1);return p.jsxs("div",{className:"",children:[p.jsx(ht,{address:t,isOpen:o,setModalOpen:r}),n.filter(s=>s.mapNumber!==void 0).sort((s,c)=>c.total-s.total).map((s,c)=>p.jsx("div",{className:"mx-auto w-full max-w-md p-2",children:p.jsx(Z,{title:p.jsx("div",{className:"p-3 w-full bg-neutral-200 dark:bg-neutral-700 text-2xl",children:`Map ${s.mapNumber} (${s.total})`}),children:s.streets.sort((l,i)=>l.street.localeCompare(i.street)).map((l,i)=>p.jsx("div",{className:"my-2 mx-6",children:p.jsx(Z,{title:p.jsx("div",{className:"p-2 w-full bg-neutral-200 dark:bg-neutral-700 rounded",children:`${l.street} ${l.addresses.length}`}),children:p.jsx("div",{className:" grid grid-cols-[repeat(auto-fill,minmax(3.5rem,1fr))]",children:l.addresses.sort((a,d)=>a.houseNumber-d.houseNumber).map((a,d)=>p.jsx("div",{children:p.jsxs("div",{onClick:()=>{e(a),r(!0)},className:`m-1 py-2 rounded text-center dark:text-white ${a.houseNumber%2===0?"dark:bg-neutral-600 bg-neutral-300":"dark:bg-neutral-800 bg-neutral-400"}`,children:[a.unitNumber&&`${a.unitNumber}/`,a.houseNumber]})},d))})},i)},i))})},c))]})},Rt=f.createContext(null);function jt(n){const t=n.clone();return t.pixelsToGLUnits=n.pixelsToGLUnits,t}function V(n){return{longitude:n.center.lng,latitude:n.center.lat,zoom:n.zoom,pitch:n.pitch,bearing:n.bearing,padding:n.padding}}function Y(n,t){const e=t.viewState||t;let o=!1;if("longitude"in e&&"latitude"in e){const r=n.center;n.center=new r.constructor(e.longitude,e.latitude),o=o||r!==n.center}if("zoom"in e){const r=n.zoom;n.zoom=e.zoom,o=o||r!==n.zoom}if("bearing"in e){const r=n.bearing;n.bearing=e.bearing,o=o||r!==n.bearing}if("pitch"in e){const r=n.pitch;n.pitch=e.pitch,o=o||r!==n.pitch}return e.padding&&!n.isPaddingEqual(e.padding)&&(o=!0,n.padding=e.padding),o}const Pt=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function X(n){if(!n)return null;if(typeof n=="string"||("toJS"in n&&(n=n.toJS()),!n.layers))return n;const t={};for(const o of n.layers)t[o.id]=o;const e=n.layers.map(o=>{const r=t[o.ref];let s=null;if("interactive"in o&&(s={...o},delete s.interactive),r){s=s||{...o},delete s.ref;for(const c of Pt)c in r&&(s[c]=r[c])}return s||o});return{...n,layers:e}}function kt(n,t){const e=Array.isArray(n)?n[0]:n?n.x:0,o=Array.isArray(n)?n[1]:n?n.y:0,r=Array.isArray(t)?t[0]:t?t.x:0,s=Array.isArray(t)?t[1]:t?t.y:0;return e===r&&o===s}function C(n,t){if(n===t)return!0;if(!n||!t)return!1;if(Array.isArray(n)){if(!Array.isArray(t)||n.length!==t.length)return!1;for(let e=0;e<n.length;e++)if(!C(n[e],t[e]))return!1;return!0}else if(Array.isArray(t))return!1;if(typeof n=="object"&&typeof t=="object"){const e=Object.keys(n),o=Object.keys(t);if(e.length!==o.length)return!1;for(const r of e)if(!t.hasOwnProperty(r)||!C(n[r],t[r]))return!1;return!0}return!1}const tt={mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",click:"onClick",dblclick:"onDblClick",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",mouseout:"onMouseOut",contextmenu:"onContextMenu",touchstart:"onTouchStart",touchend:"onTouchEnd",touchmove:"onTouchMove",touchcancel:"onTouchCancel"},U={movestart:"onMoveStart",move:"onMove",moveend:"onMoveEnd",dragstart:"onDragStart",drag:"onDrag",dragend:"onDragEnd",zoomstart:"onZoomStart",zoom:"onZoom",zoomend:"onZoomEnd",rotatestart:"onRotateStart",rotate:"onRotate",rotateend:"onRotateEnd",pitchstart:"onPitchStart",pitch:"onPitch",pitchend:"onPitchEnd"},et={wheel:"onWheel",boxzoomstart:"onBoxZoomStart",boxzoomend:"onBoxZoomEnd",boxzoomcancel:"onBoxZoomCancel",resize:"onResize",load:"onLoad",render:"onRender",idle:"onIdle",remove:"onRemove",data:"onData",styledata:"onStyleData",sourcedata:"onSourceData",error:"onError"},Ot=["minZoom","maxZoom","minPitch","maxPitch","maxBounds","projection","renderWorldCopies"],zt=["scrollZoom","boxZoom","dragRotate","dragPan","keyboard","doubleClickZoom","touchZoomRotate","touchPitch"];class j{constructor(t,e,o){this._map=null,this._internalUpdate=!1,this._inRender=!1,this._hoveredFeatures=null,this._deferredEvents={move:!1,zoom:!1,pitch:!1,rotate:!1},this._onEvent=r=>{const s=this.props[et[r.type]];s&&s(r)},this._onPointerEvent=r=>{(r.type==="mousemove"||r.type==="mouseout")&&this._updateHover(r);const s=this.props[tt[r.type]];s&&(this.props.interactiveLayerIds&&r.type!=="mouseover"&&r.type!=="mouseout"&&(r.features=this._hoveredFeatures||this._queryRenderedFeatures(r.point)),s(r),delete r.features)},this._onCameraEvent=r=>{if(!this._internalUpdate){const s=this.props[U[r.type]];s&&s(r)}r.type in this._deferredEvents&&(this._deferredEvents[r.type]=!1)},this._MapClass=t,this.props=e,this._initialize(o)}get map(){return this._map}get transform(){return this._renderTransform}setProps(t){const e=this.props;this.props=t;const o=this._updateSettings(t,e);o&&this._createShadowTransform(this._map);const r=this._updateSize(t),s=this._updateViewState(t,!0);this._updateStyle(t,e),this._updateStyleComponents(t,e),this._updateHandlers(t,e),(o||r||s&&!this._map.isMoving())&&this.redraw()}static reuse(t,e){const o=j.savedMaps.pop();if(!o)return null;const r=o.map,s=r.getContainer();for(e.className=s.className;s.childNodes.length>0;)e.appendChild(s.childNodes[0]);r._container=e;const c=r._resizeObserver;c&&(c.disconnect(),c.observe(e)),o.setProps({...t,styleDiffing:!1}),r.resize();const{initialViewState:l}=t;return l&&(l.bounds?r.fitBounds(l.bounds,{...l.fitBoundsOptions,duration:0}):o._updateViewState(l,!1)),r.isStyleLoaded()?r.fire("load"):r.once("styledata",()=>r.fire("load")),r._update(),o}_initialize(t){const{props:e}=this,o={...e,...e.initialViewState,accessToken:e.mapboxAccessToken||It()||null,container:t,style:X(e.mapStyle)},r=o.initialViewState||o.viewState||o;if(Object.assign(o,{center:[r.longitude||0,r.latitude||0],zoom:r.zoom||0,pitch:r.pitch||0,bearing:r.bearing||0}),e.gl){const a=HTMLCanvasElement.prototype.getContext;HTMLCanvasElement.prototype.getContext=()=>(HTMLCanvasElement.prototype.getContext=a,e.gl)}const s=new this._MapClass(o);r.padding&&s.setPadding(r.padding),e.cursor&&(s.getCanvas().style.cursor=e.cursor),this._createShadowTransform(s);const c=s._render;s._render=a=>{this._inRender=!0,c.call(s,a),this._inRender=!1};const l=s._renderTaskQueue.run;s._renderTaskQueue.run=a=>{l.call(s._renderTaskQueue,a),this._onBeforeRepaint()},s.on("render",()=>this._onAfterRepaint());const i=s.fire;s.fire=this._fireEvent.bind(this,i),s.on("resize",()=>{this._renderTransform.resize(s.transform.width,s.transform.height)}),s.on("styledata",()=>this._updateStyleComponents(this.props,{})),s.on("sourcedata",()=>this._updateStyleComponents(this.props,{}));for(const a in tt)s.on(a,this._onPointerEvent);for(const a in U)s.on(a,this._onCameraEvent);for(const a in et)s.on(a,this._onEvent);this._map=s}recycle(){const e=this.map.getContainer().querySelector("[mapboxgl-children]");e==null||e.remove(),j.savedMaps.push(this)}destroy(){this._map.remove()}redraw(){const t=this._map;!this._inRender&&t.style&&(t._frame&&(t._frame.cancel(),t._frame=null),t._render())}_createShadowTransform(t){const e=jt(t.transform);t.painter.transform=e,this._renderTransform=e}_updateSize(t){const{viewState:e}=t;if(e){const o=this._map;if(e.width!==o.transform.width||e.height!==o.transform.height)return o.resize(),!0}return!1}_updateViewState(t,e){if(this._internalUpdate)return!1;const o=this._map,r=this._renderTransform,{zoom:s,pitch:c,bearing:l}=r,i=o.isMoving();i&&(r.cameraElevationReference="sea");const a=Y(r,{...V(o.transform),...t});if(i&&(r.cameraElevationReference="ground"),a&&e){const d=this._deferredEvents;d.move=!0,d.zoom||(d.zoom=s!==r.zoom),d.rotate||(d.rotate=l!==r.bearing),d.pitch||(d.pitch=c!==r.pitch)}return i||Y(o.transform,t),a}_updateSettings(t,e){const o=this._map;let r=!1;for(const s of Ot)s in t&&!C(t[s],e[s])&&(r=!0,o[`set${s[0].toUpperCase()}${s.slice(1)}`](t[s]));return r}_updateStyle(t,e){if(t.cursor!==e.cursor&&(this._map.getCanvas().style.cursor=t.cursor),t.mapStyle!==e.mapStyle){const o={diff:t.styleDiffing};return"localIdeographFontFamily"in t&&(o.localIdeographFontFamily=t.localIdeographFontFamily),this._map.setStyle(X(t.mapStyle),o),!0}return!1}_updateStyleComponents(t,e){const o=this._map;let r=!1;return o.style.loaded()&&("light"in t&&!C(t.light,e.light)&&(r=!0,o.setLight(t.light)),"fog"in t&&!C(t.fog,e.fog)&&(r=!0,o.setFog(t.fog)),"terrain"in t&&!C(t.terrain,e.terrain)&&(!t.terrain||o.getSource(t.terrain.source))&&(r=!0,o.setTerrain(t.terrain))),r}_updateHandlers(t,e){const o=this._map;let r=!1;for(const s of zt){const c=t[s];C(c,e[s])||(r=!0,c?o[s].enable(c):o[s].disable())}return r}_queryRenderedFeatures(t){const e=this._map,{interactiveLayerIds:o=[]}=this.props;try{return e.queryRenderedFeatures(t,{layers:o.filter(e.getLayer.bind(e))})}catch{return[]}}_updateHover(t){var e;const{props:o}=this;if(o.interactiveLayerIds&&(o.onMouseMove||o.onMouseEnter||o.onMouseLeave)){const s=t.type,c=((e=this._hoveredFeatures)===null||e===void 0?void 0:e.length)>0,l=this._queryRenderedFeatures(t.point),i=l.length>0;!i&&c&&(t.type="mouseleave",this._onPointerEvent(t)),this._hoveredFeatures=l,i&&!c&&(t.type="mouseenter",this._onPointerEvent(t)),t.type=s}else this._hoveredFeatures=null}_fireEvent(t,e,o){const r=this._map,s=r.transform,c=typeof e=="string"?e:e.type;return c==="move"&&this._updateViewState(this.props,!1),c in U&&(typeof e=="object"&&(e.viewState=V(s)),this._map.isMoving())?(r.transform=this._renderTransform,t.call(r,e,o),r.transform=s,r):(t.call(r,e,o),r)}_onBeforeRepaint(){const t=this._map;this._internalUpdate=!0;for(const o in this._deferredEvents)this._deferredEvents[o]&&t.fire(o);this._internalUpdate=!1;const e=this._map.transform;this._map.transform=this._renderTransform,this._onAfterRepaint=()=>{this._map.transform=e}}}j.savedMaps=[];function It(){let n=null;if(typeof location<"u"){const t=/access_token=([^&\/]*)/.exec(location.search);n=t&&t[1]}try{n=n||{}.MapboxAccessToken}catch{}try{n=n||{}.REACT_APP_MAPBOX_ACCESS_TOKEN}catch{}return n}const Ft=["setMaxBounds","setMinZoom","setMaxZoom","setMinPitch","setMaxPitch","setRenderWorldCopies","setProjection","setStyle","addSource","removeSource","addLayer","removeLayer","setLayerZoomRange","setFilter","setPaintProperty","setLayoutProperty","setLight","setTerrain","setFog","remove"];function Zt(n,t){if(!n)return null;const e=n.map,o={getMap:()=>e,getCenter:()=>n.transform.center,getZoom:()=>n.transform.zoom,getBearing:()=>n.transform.bearing,getPitch:()=>n.transform.pitch,getPadding:()=>n.transform.padding,getBounds:()=>n.transform.getBounds(),project:r=>n.transform.locationPoint(t.LngLat.convert(r)),unproject:r=>n.transform.pointLocation(t.Point.convert(r)),queryTerrainElevation:(r,s)=>{const c=e.transform;e.transform=n.transform;const l=e.queryTerrainElevation(r,s);return e.transform=c,l}};for(const r of Dt(e))!(r in o)&&!Ft.includes(r)&&(o[r]=e[r].bind(e));return o}function Dt(n){const t=new Set;let e=n;for(;e;){for(const o of Object.getOwnPropertyNames(e))o[0]!=="_"&&typeof n[o]=="function"&&o!=="fire"&&o!=="setEventedParent"&&t.add(o);e=Object.getPrototypeOf(e)}return Array.from(t)}const $t=typeof document<"u"?f.useLayoutEffect:f.useEffect,Ut=["baseApiUrl","maxParallelImageRequests","workerClass","workerCount","workerUrl"];function Bt(n,t){for(const e of Ut)e in t&&(n[e]=t[e]);t.RTLTextPlugin&&n.getRTLTextPluginStatus&&n.getRTLTextPluginStatus()==="unavailable"&&n.setRTLTextPlugin(t.RTLTextPlugin,e=>{e&&console.error(e)},!1)}const D=f.createContext(null),Ht={minZoom:0,maxZoom:22,minPitch:0,maxPitch:60,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,mapStyle:{version:8,sources:{},layers:[]},styleDiffing:!0,projection:"mercator",renderWorldCopies:!0,onError:n=>console.error(n.error),RTLTextPlugin:"https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-rtl-text/v0.2.3/mapbox-gl-rtl-text.js"},Q=f.forwardRef((n,t)=>{const e=f.useContext(Rt),[o,r]=f.useState(null),s=f.useRef(),{current:c}=f.useRef({mapLib:null,map:null});f.useEffect(()=>{const a=n.mapLib;let d=!0,u;return Promise.resolve(a||wt(()=>import("./mapbox-gl-af104ab5.js").then(h=>h.m),["assets/mapbox-gl-af104ab5.js","assets/index-c712c176.js","assets/index-140e8b5e.css"])).then(h=>{if(d){if(h.Map||(h=h.default),!h||!h.Map)throw new Error("Invalid mapLib");if(Bt(h,n),!h.supported||h.supported(n))n.reuseMaps&&(u=j.reuse(n,s.current)),u||(u=new j(h.Map,n,s.current)),c.map=Zt(u,h),c.mapLib=h,r(u),e==null||e.onMapMount(c.map,n.id);else throw new Error("Map is not supported by this browser")}}).catch(h=>{n.onError({type:"error",target:null,originalEvent:null,error:h})}),()=>{d=!1,u&&(e==null||e.onMapUnmount(n.id),n.reuseMaps?u.recycle():u.destroy())}},[]),$t(()=>{o&&o.setProps(n)}),f.useImperativeHandle(t,()=>c.map,[o]);const l=f.useMemo(()=>({position:"relative",width:"100%",height:"100%",...n.style}),[n.style]),i={height:"100%"};return f.createElement("div",{id:n.id,ref:s,style:l},o&&f.createElement(D.Provider,{value:c},f.createElement("div",{"mapboxgl-children":"",style:i},n.children)))});Q.displayName="Map";Q.defaultProps=Ht;const Wt=/box|flex|grid|column|lineHeight|fontWeight|opacity|order|tabSize|zIndex/;function L(n,t){if(!n||!t)return;const e=n.style;for(const o in t){const r=t[o];Number.isFinite(r)&&!Wt.test(o)?e[o]=`${r}px`:e[o]=r}}const Gt={draggable:!1,popup:null,rotation:0,rotationAlignment:"auto",pitchAlignment:"auto"};function ft(n){const{map:t,mapLib:e}=f.useContext(D),o=f.useRef({props:n});o.current.props=n;const r=f.useMemo(()=>{let s=!1;f.Children.forEach(n.children,i=>{i&&(s=!0)});const c={...n,element:s?document.createElement("div"):null},l=new e.Marker(c).setLngLat([n.longitude,n.latitude]);return l.getElement().addEventListener("click",i=>{var a,d;(d=(a=o.current.props).onClick)===null||d===void 0||d.call(a,{type:"click",target:l,originalEvent:i})}),l.on("dragstart",i=>{var a,d;const u=i;u.lngLat=r.getLngLat(),(d=(a=o.current.props).onDragStart)===null||d===void 0||d.call(a,u)}),l.on("drag",i=>{var a,d;const u=i;u.lngLat=r.getLngLat(),(d=(a=o.current.props).onDrag)===null||d===void 0||d.call(a,u)}),l.on("dragend",i=>{var a,d;const u=i;u.lngLat=r.getLngLat(),(d=(a=o.current.props).onDragEnd)===null||d===void 0||d.call(a,u)}),l},[]);return f.useEffect(()=>(r.addTo(t.getMap()),()=>{r.remove()}),[]),f.useEffect(()=>{L(r.getElement(),n.style)},[n.style]),(r.getLngLat().lng!==n.longitude||r.getLngLat().lat!==n.latitude)&&r.setLngLat([n.longitude,n.latitude]),n.offset&&!kt(r.getOffset(),n.offset)&&r.setOffset(n.offset),r.isDraggable()!==n.draggable&&r.setDraggable(n.draggable),r.getRotation()!==n.rotation&&r.setRotation(n.rotation),r.getRotationAlignment()!==n.rotationAlignment&&r.setRotationAlignment(n.rotationAlignment),r.getPitchAlignment()!==n.pitchAlignment&&r.setPitchAlignment(n.pitchAlignment),r.getPopup()!==n.popup&&r.setPopup(n.popup),ut.createPortal(n.children,r.getElement())}ft.defaultProps=Gt;const nt=f.memo(ft);function ot(n){return new Set(n?n.trim().split(/\s+/):[])}function qt(n){const{map:t,mapLib:e}=f.useContext(D),o=f.useMemo(()=>document.createElement("div"),[]),r=f.useRef({props:n});r.current.props=n;const s=f.useMemo(()=>{const c={...n},l=new e.Popup(c).setLngLat([n.longitude,n.latitude]);return l.once("open",i=>{var a,d;(d=(a=r.current.props).onOpen)===null||d===void 0||d.call(a,i)}),l},[]);if(f.useEffect(()=>{const c=l=>{var i,a;(a=(i=r.current.props).onClose)===null||a===void 0||a.call(i,l)};return s.on("close",c),s.setDOMContent(o).addTo(t.getMap()),()=>{s.off("close",c),s.isOpen()&&s.remove()}},[]),f.useEffect(()=>{L(s.getElement(),n.style)},[n.style]),s.isOpen()&&((s.getLngLat().lng!==n.longitude||s.getLngLat().lat!==n.latitude)&&s.setLngLat([n.longitude,n.latitude]),n.offset&&!C(s.options.offset,n.offset)&&s.setOffset(n.offset),(s.options.anchor!==n.anchor||s.options.maxWidth!==n.maxWidth)&&(s.options.anchor=n.anchor,s.setMaxWidth(n.maxWidth)),s.options.className!==n.className)){const c=ot(s.options.className),l=ot(n.className);for(const i of c)l.has(i)||s.removeClassName(i);for(const i of l)c.has(i)||s.addClassName(i);s.options.className=n.className}return ut.createPortal(n.children,o)}f.memo(qt);function O(n,t,e,o){const r=f.useContext(D),s=f.useMemo(()=>n(r),[]);return f.useEffect(()=>{const c=o||e||t,l=typeof t=="function"&&typeof e=="function"?t:null,i=typeof e=="function"?e:typeof t=="function"?t:null,{map:a}=r;return a.hasControl(s)||(a.addControl(s,c==null?void 0:c.position),l&&l(r)),()=>{i&&i(r),a.hasControl(s)&&a.removeControl(s)}},[]),s}function Qt(n){const t=O(({mapLib:e})=>new e.AttributionControl(n),{position:n.position});return f.useEffect(()=>{L(t._container,n.style)},[n.style]),null}f.memo(Qt);function Jt(n){const t=O(({mapLib:e})=>new e.FullscreenControl({container:n.containerId&&document.getElementById(n.containerId)}),{position:n.position});return f.useEffect(()=>{L(t._controlContainer,n.style)},[n.style]),null}f.memo(Jt);const mt=f.forwardRef((n,t)=>{const e=f.useRef({props:n}),o=O(({mapLib:r})=>{const s=new r.GeolocateControl(n),c=s._setupUI;return s._setupUI=l=>{s._container.hasChildNodes()||c(l)},s.on("geolocate",l=>{var i,a;(a=(i=e.current.props).onGeolocate)===null||a===void 0||a.call(i,l)}),s.on("error",l=>{var i,a;(a=(i=e.current.props).onError)===null||a===void 0||a.call(i,l)}),s.on("outofmaxbounds",l=>{var i,a;(a=(i=e.current.props).onOutOfMaxBounds)===null||a===void 0||a.call(i,l)}),s.on("trackuserlocationstart",l=>{var i,a;(a=(i=e.current.props).onTrackUserLocationStart)===null||a===void 0||a.call(i,l)}),s.on("trackuserlocationend",l=>{var i,a;(a=(i=e.current.props).onTrackUserLocationEnd)===null||a===void 0||a.call(i,l)}),s},{position:n.position});return e.current.props=n,f.useImperativeHandle(t,()=>({trigger:()=>o.trigger()}),[]),f.useEffect(()=>{L(o._container,n.style)},[n.style]),null});mt.displayName="GeolocateControl";f.memo(mt);function Kt(n){const t=O(({mapLib:e})=>new e.NavigationControl(n),{position:n.position});return f.useEffect(()=>{L(t._container,n.style)},[n.style]),null}f.memo(Kt);const Vt={unit:"metric",maxWidth:100};function pt(n){const t=O(({mapLib:e})=>new e.ScaleControl(n),{position:n.position});return(t.options.unit!==n.unit||t.options.maxWidth!==n.maxWidth)&&(t.options.maxWidth=n.maxWidth,t.setUnit(n.unit)),f.useEffect(()=>{L(t._container,n.style)},[n.style]),null}pt.defaultProps=Vt;f.memo(pt);const rt=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],B=1,P=8;class J{static from(t){if(!(t instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[e,o]=new Uint8Array(t,0,2);if(e!==219)throw new Error("Data does not appear to be in a KDBush format.");const r=o>>4;if(r!==B)throw new Error(`Got v${r} data when expected v${B}.`);const s=rt[o&15];if(!s)throw new Error("Unrecognized array type.");const[c]=new Uint16Array(t,2,1),[l]=new Uint32Array(t,4,1);return new J(l,c,s,t)}constructor(t,e=64,o=Float64Array,r){if(isNaN(t)||t<0)throw new Error(`Unpexpected numItems value: ${t}.`);this.numItems=+t,this.nodeSize=Math.min(Math.max(+e,2),65535),this.ArrayType=o,this.IndexArrayType=t<65536?Uint16Array:Uint32Array;const s=rt.indexOf(this.ArrayType),c=t*2*this.ArrayType.BYTES_PER_ELEMENT,l=t*this.IndexArrayType.BYTES_PER_ELEMENT,i=(8-l%8)%8;if(s<0)throw new Error(`Unexpected typed array class: ${o}.`);r&&r instanceof ArrayBuffer?(this.data=r,this.ids=new this.IndexArrayType(this.data,P,t),this.coords=new this.ArrayType(this.data,P+l+i,t*2),this._pos=t*2,this._finished=!0):(this.data=new ArrayBuffer(P+c+l+i),this.ids=new this.IndexArrayType(this.data,P,t),this.coords=new this.ArrayType(this.data,P+l+i,t*2),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,(B<<4)+s]),new Uint16Array(this.data,2,1)[0]=e,new Uint32Array(this.data,4,1)[0]=t)}add(t,e){const o=this._pos>>1;return this.ids[o]=o,this.coords[this._pos++]=t,this.coords[this._pos++]=e,o}finish(){const t=this._pos>>1;if(t!==this.numItems)throw new Error(`Added ${t} items when expected ${this.numItems}.`);return q(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(t,e,o,r){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:s,coords:c,nodeSize:l}=this,i=[0,s.length-1,0],a=[];for(;i.length;){const d=i.pop()||0,u=i.pop()||0,h=i.pop()||0;if(u-h<=l){for(let v=h;v<=u;v++){const _=c[2*v],w=c[2*v+1];_>=t&&_<=o&&w>=e&&w<=r&&a.push(s[v])}continue}const m=h+u>>1,g=c[2*m],y=c[2*m+1];g>=t&&g<=o&&y>=e&&y<=r&&a.push(s[m]),(d===0?t<=g:e<=y)&&(i.push(h),i.push(m-1),i.push(1-d)),(d===0?o>=g:r>=y)&&(i.push(m+1),i.push(u),i.push(1-d))}return a}within(t,e,o){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:r,coords:s,nodeSize:c}=this,l=[0,r.length-1,0],i=[],a=o*o;for(;l.length;){const d=l.pop()||0,u=l.pop()||0,h=l.pop()||0;if(u-h<=c){for(let v=h;v<=u;v++)st(s[2*v],s[2*v+1],t,e)<=a&&i.push(r[v]);continue}const m=h+u>>1,g=s[2*m],y=s[2*m+1];st(g,y,t,e)<=a&&i.push(r[m]),(d===0?t-o<=g:e-o<=y)&&(l.push(h),l.push(m-1),l.push(1-d)),(d===0?t+o>=g:e+o>=y)&&(l.push(m+1),l.push(u),l.push(1-d))}return i}}function q(n,t,e,o,r,s){if(r-o<=e)return;const c=o+r>>1;gt(n,t,c,o,r,s),q(n,t,e,o,c-1,1-s),q(n,t,e,c+1,r,1-s)}function gt(n,t,e,o,r,s){for(;r>o;){if(r-o>600){const a=r-o+1,d=e-o+1,u=Math.log(a),h=.5*Math.exp(2*u/3),m=.5*Math.sqrt(u*h*(a-h)/a)*(d-a/2<0?-1:1),g=Math.max(o,Math.floor(e-d*h/a+m)),y=Math.min(r,Math.floor(e+(a-d)*h/a+m));gt(n,t,e,g,y,s)}const c=t[2*e+s];let l=o,i=r;for(k(n,t,o,e),t[2*r+s]>c&&k(n,t,o,r);l<i;){for(k(n,t,l,i),l++,i--;t[2*l+s]<c;)l++;for(;t[2*i+s]>c;)i--}t[2*o+s]===c?k(n,t,o,i):(i++,k(n,t,i,r)),i<=e&&(o=i+1),e<=i&&(r=i-1)}}function k(n,t,e,o){H(n,e,o),H(t,2*e,2*o),H(t,2*e+1,2*o+1)}function H(n,t,e){const o=n[t];n[t]=n[e],n[e]=o}function st(n,t,e,o){const r=n-e,s=t-o;return r*r+s*s}const Yt={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:n=>n},it=Math.fround||(n=>t=>(n[0]=+t,n[0]))(new Float32Array(1)),T=2,M=3,W=4,E=5,yt=6;class Xt{constructor(t){this.options=Object.assign(Object.create(Yt),t),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(t){const{log:e,minZoom:o,maxZoom:r}=this.options;e&&console.time("total time");const s=`prepare ${t.length} points`;e&&console.time(s),this.points=t;const c=[];for(let i=0;i<t.length;i++){const a=t[i];if(!a.geometry)continue;const[d,u]=a.geometry.coordinates,h=it(I(d)),m=it(F(u));c.push(h,m,1/0,i,-1,1),this.options.reduce&&c.push(0)}let l=this.trees[r+1]=this._createTree(c);e&&console.timeEnd(s);for(let i=r;i>=o;i--){const a=+Date.now();l=this.trees[i]=this._createTree(this._cluster(l,i)),e&&console.log("z%d: %d clusters in %dms",i,l.numItems,+Date.now()-a)}return e&&console.timeEnd("total time"),this}getClusters(t,e){let o=((t[0]+180)%360+360)%360-180;const r=Math.max(-90,Math.min(90,t[1]));let s=t[2]===180?180:((t[2]+180)%360+360)%360-180;const c=Math.max(-90,Math.min(90,t[3]));if(t[2]-t[0]>=360)o=-180,s=180;else if(o>s){const u=this.getClusters([o,r,180,c],e),h=this.getClusters([-180,r,s,c],e);return u.concat(h)}const l=this.trees[this._limitZoom(e)],i=l.range(I(o),F(c),I(s),F(r)),a=l.data,d=[];for(const u of i){const h=this.stride*u;d.push(a[h+E]>1?at(a,h,this.clusterProps):this.points[a[h+M]])}return d}getChildren(t){const e=this._getOriginId(t),o=this._getOriginZoom(t),r="No cluster with the specified id.",s=this.trees[o];if(!s)throw new Error(r);const c=s.data;if(e*this.stride>=c.length)throw new Error(r);const l=this.options.radius/(this.options.extent*Math.pow(2,o-1)),i=c[e*this.stride],a=c[e*this.stride+1],d=s.within(i,a,l),u=[];for(const h of d){const m=h*this.stride;c[m+W]===t&&u.push(c[m+E]>1?at(c,m,this.clusterProps):this.points[c[m+M]])}if(u.length===0)throw new Error(r);return u}getLeaves(t,e,o){e=e||10,o=o||0;const r=[];return this._appendLeaves(r,t,e,o,0),r}getTile(t,e,o){const r=this.trees[this._limitZoom(t)],s=Math.pow(2,t),{extent:c,radius:l}=this.options,i=l/c,a=(o-i)/s,d=(o+1+i)/s,u={features:[]};return this._addTileFeatures(r.range((e-i)/s,a,(e+1+i)/s,d),r.data,e,o,s,u),e===0&&this._addTileFeatures(r.range(1-i/s,a,1,d),r.data,s,o,s,u),e===s-1&&this._addTileFeatures(r.range(0,a,i/s,d),r.data,-1,o,s,u),u.features.length?u:null}getClusterExpansionZoom(t){let e=this._getOriginZoom(t)-1;for(;e<=this.options.maxZoom;){const o=this.getChildren(t);if(e++,o.length!==1)break;t=o[0].properties.cluster_id}return e}_appendLeaves(t,e,o,r,s){const c=this.getChildren(e);for(const l of c){const i=l.properties;if(i&&i.cluster?s+i.point_count<=r?s+=i.point_count:s=this._appendLeaves(t,i.cluster_id,o,r,s):s<r?s++:t.push(l),t.length===o)break}return s}_createTree(t){const e=new J(t.length/this.stride|0,this.options.nodeSize,Float32Array);for(let o=0;o<t.length;o+=this.stride)e.add(t[o],t[o+1]);return e.finish(),e.data=t,e}_addTileFeatures(t,e,o,r,s,c){for(const l of t){const i=l*this.stride,a=e[i+E]>1;let d,u,h;if(a)d=vt(e,i,this.clusterProps),u=e[i],h=e[i+1];else{const y=this.points[e[i+M]];d=y.properties;const[v,_]=y.geometry.coordinates;u=I(v),h=F(_)}const m={type:1,geometry:[[Math.round(this.options.extent*(u*s-o)),Math.round(this.options.extent*(h*s-r))]],tags:d};let g;a||this.options.generateId?g=e[i+M]:g=this.points[e[i+M]].id,g!==void 0&&(m.id=g),c.features.push(m)}}_limitZoom(t){return Math.max(this.options.minZoom,Math.min(Math.floor(+t),this.options.maxZoom+1))}_cluster(t,e){const{radius:o,extent:r,reduce:s,minPoints:c}=this.options,l=o/(r*Math.pow(2,e)),i=t.data,a=[],d=this.stride;for(let u=0;u<i.length;u+=d){if(i[u+T]<=e)continue;i[u+T]=e;const h=i[u],m=i[u+1],g=t.within(i[u],i[u+1],l),y=i[u+E];let v=y;for(const _ of g){const w=_*d;i[w+T]>e&&(v+=i[w+E])}if(v>y&&v>=c){let _=h*y,w=m*y,x,S=-1;const A=((u/d|0)<<5)+(e+1)+this.points.length;for(const R of g){const b=R*d;if(i[b+T]<=e)continue;i[b+T]=e;const z=i[b+E];_+=i[b]*z,w+=i[b+1]*z,i[b+W]=A,s&&(x||(x=this._map(i,u,!0),S=this.clusterProps.length,this.clusterProps.push(x)),s(x,this._map(i,b)))}i[u+W]=A,a.push(_/v,w/v,1/0,A,-1,v),s&&a.push(S)}else{for(let _=0;_<d;_++)a.push(i[u+_]);if(v>1)for(const _ of g){const w=_*d;if(!(i[w+T]<=e)){i[w+T]=e;for(let x=0;x<d;x++)a.push(i[w+x])}}}}return a}_getOriginId(t){return t-this.points.length>>5}_getOriginZoom(t){return(t-this.points.length)%32}_map(t,e,o){if(t[e+E]>1){const c=this.clusterProps[t[e+yt]];return o?Object.assign({},c):c}const r=this.points[t[e+M]].properties,s=this.options.map(r);return o&&s===r?Object.assign({},s):s}}function at(n,t,e){return{type:"Feature",id:n[t+M],properties:vt(n,t,e),geometry:{type:"Point",coordinates:[te(n[t]),ee(n[t+1])]}}}function vt(n,t,e){const o=n[t+E],r=o>=1e4?`${Math.round(o/1e3)}k`:o>=1e3?`${Math.round(o/100)/10}k`:o,s=n[t+yt],c=s===-1?{}:Object.assign({},e[s]);return Object.assign(c,{cluster:!0,cluster_id:n[t+M],point_count:o,point_count_abbreviated:r})}function I(n){return n/360+.5}function F(n){const t=Math.sin(n*Math.PI/180),e=.5-.25*Math.log((1+t)/(1-t))/Math.PI;return e<0?0:e>1?1:e}function te(n){return(n-.5)*360}function ee(n){const t=(180-n*360)*Math.PI/180;return 360*Math.atan(Math.exp(t))/Math.PI-90}var ct=Object.prototype.hasOwnProperty;function lt(n,t,e){for(e of n.keys())if(N(e,t))return e}function N(n,t){var e,o,r;if(n===t)return!0;if(n&&t&&(e=n.constructor)===t.constructor){if(e===Date)return n.getTime()===t.getTime();if(e===RegExp)return n.toString()===t.toString();if(e===Array){if((o=n.length)===t.length)for(;o--&&N(n[o],t[o]););return o===-1}if(e===Set){if(n.size!==t.size)return!1;for(o of n)if(r=o,r&&typeof r=="object"&&(r=lt(t,r),!r)||!t.has(r))return!1;return!0}if(e===Map){if(n.size!==t.size)return!1;for(o of n)if(r=o[0],r&&typeof r=="object"&&(r=lt(t,r),!r)||!N(o[1],t.get(r)))return!1;return!0}if(e===ArrayBuffer)n=new Uint8Array(n),t=new Uint8Array(t);else if(e===DataView){if((o=n.byteLength)===t.byteLength)for(;o--&&n.getInt8(o)===t.getInt8(o););return o===-1}if(ArrayBuffer.isView(n)){if((o=n.byteLength)===t.byteLength)for(;o--&&n[o]===t[o];);return o===-1}if(!e||typeof n=="object"){o=0;for(e in n)if(ct.call(n,e)&&++o&&!ct.call(t,e)||!(e in t)||!N(n[e],t[e]))return!1;return Object.keys(t).length===o}}return n!==n&&t!==t}function ne(n){var t=f.useRef(n),e=f.useRef(0);return N(n,t.current)||(t.current=n,e.current+=1),f.useMemo(function(){return t.current},[e.current])}function oe(n,t){return f.useEffect(n,ne(t))}var re=function(t){var e=t.points,o=t.bounds,r=t.zoom,s=t.options,c=f.useRef(),l=f.useRef(),i=f.useState([]),a=i[0],d=i[1],u=Math.round(r);return oe(function(){(!c.current||!N(l.current,e)||!N(c.current.options,s))&&(c.current=new Xt(s),c.current.load(e)),o&&d(c.current.getClusters(o,u)),l.current=e},[e,o,u,s]),{clusters:a,supercluster:c.current}};const se={latitude:-32.7316,longitude:151.5525},ie=({children:n,notAtHomesList:t})=>{const[e,o]=f.useState({latitude:52.6376,longitude:-1.135171,width:"100vw",height:"100vh",zoom:12}),{ternaryDarkMode:r}=bt(),s=f.useRef(null),c=t.filter(u=>u.lat!==void 0).filter(u=>u.letter!==!0).map(u=>({type:"Feature",properties:{cluster:!1,crimeId:u.id,category:u.houseNumber,unitNumber:u.unitNumber},geometry:{type:"Point",coordinates:[u.lng,u.lat]}})),l={radius:75,maxZoom:15},i=s.current?s.current.getMap().getBounds().toArray().flat():null,{clusters:a,supercluster:d}=re({points:c,bounds:i,zoom:e.zoom,options:l});return p.jsx("div",{className:"h-full",children:p.jsx(Q,{initialViewState:{...se,zoom:e.zoom},mapStyle:`mapbox://styles/damianamodeo/${r?"clefix5la000901po4wflstdd":"clefifzvz000u01nw8h84n67m"}`,mapboxAccessToken:"pk.eyJ1IjoiZGFtaWFuYW1vZGVvIiwiYSI6ImNqeWxnb3lsejA4OXozYmxpajhzMXdvZjQifQ.OJBOK5ZvGEX2VaScbW_zUQ",ref:s,onMoveEnd:u=>{o({...e,zoom:s.current?s.current.getZoom():null})},style:{width:"100%",height:"100%"},children:a.map(u=>{const[h,m]=u.geometry.coordinates,{cluster:g,point_count:y,category:v,unitNumber:_}=u.properties;if(u.properties.id,g)return p.jsx(nt,{latitude:m,longitude:h,children:p.jsx("div",{className:"cluster-marker",style:{width:`${10+y/c.length*20}px`,height:`${10+y/c.length*20}px`},onClick:w=>{var x;(x=s.current)==null||x.easeTo({center:[h,m],zoom:d==null?void 0:d.getClusterExpansionZoom(u.id),duration:500}),o({...e,zoom:d==null?void 0:d.getClusterExpansionZoom(u.id)})},children:p.jsx("div",{className:"w-12 h-12 bg-white grid place-items-center text-lg rounded-full",children:y})})},`cluster-${u.id}`);if(_!==""&&typeof parseInt(_)=="number"){const w=parseInt(_);let x=4.5,S=1,A=1,R=15e4,b=Math.sqrt(w)-.8,z=Math.sqrt(w)+b/(w*.2);x=x*b,S=S*z,A=A,R=R*1;const K=x*A,_t=h+(S+K)*Math.cos(x)/R,xt=m+(S+K)*Math.sin(x)/R;return console.log(x),p.jsx(nt,{longitude:parseFloat(_t.toFixed(6)),latitude:parseFloat(xt.toFixed(6)),children:p.jsx("button",{className:"bg-red-500 rounded-full w-6 h-6 text-lg-xx grid place-items-center",children:_})},`crime-${u.properties.crimeId}`)}})})})},ae=({children:n,notAtHomesList:t})=>p.jsx("div",{className:"h-full",children:p.jsx(ie,{notAtHomesList:t})}),me=({changeSubpage:n})=>{const[t,e]=f.useState([{key:""}]),[o,r]=f.useState([]),[s,c]=f.useState([]);return f.useEffect(()=>At(dt(G,"notAtHomes","MaitlandCongregation"),i=>{const a=i.data(),d=a?Object.keys(a).map(u=>({key:u,...a[u]})):[];e(d),r(d.reduce((u,h)=>{if(h.letter)return u;const m=u.findIndex(g=>g.mapNumber===`${h.mapNumber}`);if(m<0)u.push({mapNumber:h.mapNumber,total:1,streets:[{street:h.street,addresses:[h]}]});else{u[m].total=u[m].total+1;const g=u[m].streets.findIndex(y=>y.street===`${h.street}`);g<0?u[m].streets.push({street:h.street,addresses:[h]}):u[m].streets[g].addresses.push(h)}return u},[])),c(d.reduce((u,h)=>{if(h.letter)return u;const m=u.findIndex(g=>g.suburb===`${h.suburb}`);if(m<0)u.push({suburb:h.suburb,total:1,streets:[{street:h.street,addresses:[h]}]});else{u[m].total=u[m].total+1;const g=u[m].streets.findIndex(y=>y.street===`${h.street}`);g<0?u[m].streets.push({street:h.street,addresses:[h]}):u[m].streets[g].addresses.push(h)}return u},[]))}),[]),p.jsx("div",{className:"h-full",children:p.jsx(Mt,{color:"blue",tabItems:[{title:"Map View",content:p.jsx(ae,{notAtHomesList:t})},{title:"Suburb",content:p.jsx(Nt,{suburbs:s})},{title:"Map ID",content:p.jsx(Lt,{mapNumbers:o})}]})})};export{me as default};
