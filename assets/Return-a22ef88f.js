import{j as p,r as f,_ as vt,a as ct,u as _t}from"./index-c0567344.js";import{M as wt,B as Z,T as xt}from"./Modal-8d90d6b2.js";import{r as lt,f as B,b as bt,d as Et,c as Mt}from"./deleteNotAtHome-63823a81.js";import{A as O}from"./Disclosure-71330305.js";import"./transition-b9ddcc7c.js";import"./upDownArrow-3ca4e2a2.js";const Ct=async(n,t,e)=>{const o=lt(B,"notAtHomes","MaitlandCongregation");try{return await bt(B,async r=>{const c=await r.get(o).then(l=>l.data());r.update(o,{...c,[n.key]:{...c[n.key],[t]:e}})})}catch(s){return console.error(s.message),s}},ut=({isOpen:n,address:t,setModalOpen:e})=>p.jsxs(wt,{isOpen:n,onClose:()=>{},title:"",height:"md",children:[p.jsxs("div",{className:"h-full text-center text-xl dark:text-white",children:[(t==null?void 0:t.unitNumber)&&`${t==null?void 0:t.unitNumber}/`,t==null?void 0:t.houseNumber," ",t==null?void 0:t.street,", ",t==null?void 0:t.suburb]}),p.jsxs("div",{className:"grid place-items-center gap-4",children:[p.jsx(Z,{width:"md",clickAction:()=>e(!1),color:"blue",children:"cancel"}),p.jsx(Z,{width:"md",clickAction:()=>{Ct(t,"letter",!0),e(!1)},color:"blue",children:"Letter List"}),p.jsx(Z,{width:"md",clickAction:()=>{Et(t),e(!1)},color:"blue",children:"Delete"})]})]}),St=({suburbs:n})=>{const[t,e]=f.useState(void 0),[o,s]=f.useState(!1);return p.jsxs("div",{className:"",children:[p.jsx(ut,{address:t,isOpen:o,setModalOpen:s}),n.filter(r=>r.suburb!==void 0).sort((r,c)=>c.total-r.total).map((r,c)=>p.jsx("div",{className:"mx-auto w-full max-w-md p-2",children:p.jsx(O,{title:p.jsxs("div",{className:"p-3 text-2xl",children:[`${r.suburb} (${r.total})`," "]}),children:r.streets.sort((l,i)=>l.street.localeCompare(i.street)).map((l,i)=>p.jsx("div",{className:"my-2 mx-6",children:p.jsx(O,{title:p.jsx("div",{className:"p-2 w-full bg-neutral-200 dark:bg-neutral-700 rounded",children:`${l.street} ${l.addresses.length}`}),children:p.jsx("div",{className:" grid grid-cols-[repeat(auto-fill,minmax(3.5rem,1fr))]",children:l.addresses.sort((a,d)=>a.houseNumber-d.houseNumber).map((a,d)=>p.jsx("div",{children:p.jsxs("div",{onClick:()=>{e(a),s(!0)},className:`m-1 py-2 rounded text-center dark:text-white ${a.houseNumber%2===0?"dark:bg-neutral-600 bg-neutral-300":"dark:bg-neutral-800 bg-neutral-400"}`,children:[a.unitNumber&&`${a.unitNumber}/`,a.houseNumber]})},d))})},i)},i))})},c))]})},At=({mapNumbers:n})=>{const[t,e]=f.useState(void 0),[o,s]=f.useState(!1);return p.jsxs("div",{className:"",children:[p.jsx(ut,{address:t,isOpen:o,setModalOpen:s}),n.filter(r=>r.mapNumber!==void 0).sort((r,c)=>c.total-r.total).map((r,c)=>p.jsx("div",{className:"mx-auto w-full max-w-md p-2",children:p.jsx(O,{title:p.jsx("div",{className:"p-3 w-full bg-neutral-200 dark:bg-neutral-700 text-2xl",children:`Map ${r.mapNumber} (${r.total})`}),children:r.streets.sort((l,i)=>l.street.localeCompare(i.street)).map((l,i)=>p.jsx("div",{className:"my-2 mx-6",children:p.jsx(O,{title:p.jsx("div",{className:"p-2 w-full bg-neutral-200 dark:bg-neutral-700 rounded",children:`${l.street} ${l.addresses.length}`}),children:p.jsx("div",{className:" grid grid-cols-[repeat(auto-fill,minmax(3.5rem,1fr))]",children:l.addresses.sort((a,d)=>a.houseNumber-d.houseNumber).map((a,d)=>p.jsx("div",{children:p.jsxs("div",{onClick:()=>{e(a),s(!0)},className:`m-1 py-2 rounded text-center dark:text-white ${a.houseNumber%2===0?"dark:bg-neutral-600 bg-neutral-300":"dark:bg-neutral-800 bg-neutral-400"}`,children:[a.unitNumber&&`${a.unitNumber}/`,a.houseNumber]})},d))})},i)},i))})},c))]})},Tt=f.createContext(null);function Lt(n){const t=n.clone();return t.pixelsToGLUnits=n.pixelsToGLUnits,t}function J(n){return{longitude:n.center.lng,latitude:n.center.lat,zoom:n.zoom,pitch:n.pitch,bearing:n.bearing,padding:n.padding}}function K(n,t){const e=t.viewState||t;let o=!1;if("longitude"in e&&"latitude"in e){const s=n.center;n.center=new s.constructor(e.longitude,e.latitude),o=o||s!==n.center}if("zoom"in e){const s=n.zoom;n.zoom=e.zoom,o=o||s!==n.zoom}if("bearing"in e){const s=n.bearing;n.bearing=e.bearing,o=o||s!==n.bearing}if("pitch"in e){const s=n.pitch;n.pitch=e.pitch,o=o||s!==n.pitch}return e.padding&&!n.isPaddingEqual(e.padding)&&(o=!0,n.padding=e.padding),o}const Nt=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function V(n){if(!n)return null;if(typeof n=="string"||("toJS"in n&&(n=n.toJS()),!n.layers))return n;const t={};for(const o of n.layers)t[o.id]=o;const e=n.layers.map(o=>{const s=t[o.ref];let r=null;if("interactive"in o&&(r={...o},delete r.interactive),s){r=r||{...o},delete r.ref;for(const c of Nt)c in s&&(r[c]=s[c])}return r||o});return{...n,layers:e}}function Rt(n,t){const e=Array.isArray(n)?n[0]:n?n.x:0,o=Array.isArray(n)?n[1]:n?n.y:0,s=Array.isArray(t)?t[0]:t?t.x:0,r=Array.isArray(t)?t[1]:t?t.y:0;return e===s&&o===r}function M(n,t){if(n===t)return!0;if(!n||!t)return!1;if(Array.isArray(n)){if(!Array.isArray(t)||n.length!==t.length)return!1;for(let e=0;e<n.length;e++)if(!M(n[e],t[e]))return!1;return!0}else if(Array.isArray(t))return!1;if(typeof n=="object"&&typeof t=="object"){const e=Object.keys(n),o=Object.keys(t);if(e.length!==o.length)return!1;for(const s of e)if(!t.hasOwnProperty(s)||!M(n[s],t[s]))return!1;return!0}return!1}const Y={mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",click:"onClick",dblclick:"onDblClick",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",mouseout:"onMouseOut",contextmenu:"onContextMenu",touchstart:"onTouchStart",touchend:"onTouchEnd",touchmove:"onTouchMove",touchcancel:"onTouchCancel"},F={movestart:"onMoveStart",move:"onMove",moveend:"onMoveEnd",dragstart:"onDragStart",drag:"onDrag",dragend:"onDragEnd",zoomstart:"onZoomStart",zoom:"onZoom",zoomend:"onZoomEnd",rotatestart:"onRotateStart",rotate:"onRotate",rotateend:"onRotateEnd",pitchstart:"onPitchStart",pitch:"onPitch",pitchend:"onPitchEnd"},X={wheel:"onWheel",boxzoomstart:"onBoxZoomStart",boxzoomend:"onBoxZoomEnd",boxzoomcancel:"onBoxZoomCancel",resize:"onResize",load:"onLoad",render:"onRender",idle:"onIdle",remove:"onRemove",data:"onData",styledata:"onStyleData",sourcedata:"onSourceData",error:"onError"},jt=["minZoom","maxZoom","minPitch","maxPitch","maxBounds","projection","renderWorldCopies"],Pt=["scrollZoom","boxZoom","dragRotate","dragPan","keyboard","doubleClickZoom","touchZoomRotate","touchPitch"];class L{constructor(t,e,o){this._map=null,this._internalUpdate=!1,this._inRender=!1,this._hoveredFeatures=null,this._deferredEvents={move:!1,zoom:!1,pitch:!1,rotate:!1},this._onEvent=s=>{const r=this.props[X[s.type]];r&&r(s)},this._onPointerEvent=s=>{(s.type==="mousemove"||s.type==="mouseout")&&this._updateHover(s);const r=this.props[Y[s.type]];r&&(this.props.interactiveLayerIds&&s.type!=="mouseover"&&s.type!=="mouseout"&&(s.features=this._hoveredFeatures||this._queryRenderedFeatures(s.point)),r(s),delete s.features)},this._onCameraEvent=s=>{if(!this._internalUpdate){const r=this.props[F[s.type]];r&&r(s)}s.type in this._deferredEvents&&(this._deferredEvents[s.type]=!1)},this._MapClass=t,this.props=e,this._initialize(o)}get map(){return this._map}get transform(){return this._renderTransform}setProps(t){const e=this.props;this.props=t;const o=this._updateSettings(t,e);o&&this._createShadowTransform(this._map);const s=this._updateSize(t),r=this._updateViewState(t,!0);this._updateStyle(t,e),this._updateStyleComponents(t,e),this._updateHandlers(t,e),(o||s||r&&!this._map.isMoving())&&this.redraw()}static reuse(t,e){const o=L.savedMaps.pop();if(!o)return null;const s=o.map,r=s.getContainer();for(e.className=r.className;r.childNodes.length>0;)e.appendChild(r.childNodes[0]);s._container=e;const c=s._resizeObserver;c&&(c.disconnect(),c.observe(e)),o.setProps({...t,styleDiffing:!1}),s.resize();const{initialViewState:l}=t;return l&&(l.bounds?s.fitBounds(l.bounds,{...l.fitBoundsOptions,duration:0}):o._updateViewState(l,!1)),s.isStyleLoaded()?s.fire("load"):s.once("styledata",()=>s.fire("load")),s._update(),o}_initialize(t){const{props:e}=this,o={...e,...e.initialViewState,accessToken:e.mapboxAccessToken||kt()||null,container:t,style:V(e.mapStyle)},s=o.initialViewState||o.viewState||o;if(Object.assign(o,{center:[s.longitude||0,s.latitude||0],zoom:s.zoom||0,pitch:s.pitch||0,bearing:s.bearing||0}),e.gl){const a=HTMLCanvasElement.prototype.getContext;HTMLCanvasElement.prototype.getContext=()=>(HTMLCanvasElement.prototype.getContext=a,e.gl)}const r=new this._MapClass(o);s.padding&&r.setPadding(s.padding),e.cursor&&(r.getCanvas().style.cursor=e.cursor),this._createShadowTransform(r);const c=r._render;r._render=a=>{this._inRender=!0,c.call(r,a),this._inRender=!1};const l=r._renderTaskQueue.run;r._renderTaskQueue.run=a=>{l.call(r._renderTaskQueue,a),this._onBeforeRepaint()},r.on("render",()=>this._onAfterRepaint());const i=r.fire;r.fire=this._fireEvent.bind(this,i),r.on("resize",()=>{this._renderTransform.resize(r.transform.width,r.transform.height)}),r.on("styledata",()=>this._updateStyleComponents(this.props,{})),r.on("sourcedata",()=>this._updateStyleComponents(this.props,{}));for(const a in Y)r.on(a,this._onPointerEvent);for(const a in F)r.on(a,this._onCameraEvent);for(const a in X)r.on(a,this._onEvent);this._map=r}recycle(){const e=this.map.getContainer().querySelector("[mapboxgl-children]");e==null||e.remove(),L.savedMaps.push(this)}destroy(){this._map.remove()}redraw(){const t=this._map;!this._inRender&&t.style&&(t._frame&&(t._frame.cancel(),t._frame=null),t._render())}_createShadowTransform(t){const e=Lt(t.transform);t.painter.transform=e,this._renderTransform=e}_updateSize(t){const{viewState:e}=t;if(e){const o=this._map;if(e.width!==o.transform.width||e.height!==o.transform.height)return o.resize(),!0}return!1}_updateViewState(t,e){if(this._internalUpdate)return!1;const o=this._map,s=this._renderTransform,{zoom:r,pitch:c,bearing:l}=s,i=o.isMoving();i&&(s.cameraElevationReference="sea");const a=K(s,{...J(o.transform),...t});if(i&&(s.cameraElevationReference="ground"),a&&e){const d=this._deferredEvents;d.move=!0,d.zoom||(d.zoom=r!==s.zoom),d.rotate||(d.rotate=l!==s.bearing),d.pitch||(d.pitch=c!==s.pitch)}return i||K(o.transform,t),a}_updateSettings(t,e){const o=this._map;let s=!1;for(const r of jt)r in t&&!M(t[r],e[r])&&(s=!0,o[`set${r[0].toUpperCase()}${r.slice(1)}`](t[r]));return s}_updateStyle(t,e){if(t.cursor!==e.cursor&&(this._map.getCanvas().style.cursor=t.cursor),t.mapStyle!==e.mapStyle){const o={diff:t.styleDiffing};return"localIdeographFontFamily"in t&&(o.localIdeographFontFamily=t.localIdeographFontFamily),this._map.setStyle(V(t.mapStyle),o),!0}return!1}_updateStyleComponents(t,e){const o=this._map;let s=!1;return o.style.loaded()&&("light"in t&&!M(t.light,e.light)&&(s=!0,o.setLight(t.light)),"fog"in t&&!M(t.fog,e.fog)&&(s=!0,o.setFog(t.fog)),"terrain"in t&&!M(t.terrain,e.terrain)&&(!t.terrain||o.getSource(t.terrain.source))&&(s=!0,o.setTerrain(t.terrain))),s}_updateHandlers(t,e){const o=this._map;let s=!1;for(const r of Pt){const c=t[r];M(c,e[r])||(s=!0,c?o[r].enable(c):o[r].disable())}return s}_queryRenderedFeatures(t){const e=this._map,{interactiveLayerIds:o=[]}=this.props;try{return e.queryRenderedFeatures(t,{layers:o.filter(e.getLayer.bind(e))})}catch{return[]}}_updateHover(t){var e;const{props:o}=this;if(o.interactiveLayerIds&&(o.onMouseMove||o.onMouseEnter||o.onMouseLeave)){const r=t.type,c=((e=this._hoveredFeatures)===null||e===void 0?void 0:e.length)>0,l=this._queryRenderedFeatures(t.point),i=l.length>0;!i&&c&&(t.type="mouseleave",this._onPointerEvent(t)),this._hoveredFeatures=l,i&&!c&&(t.type="mouseenter",this._onPointerEvent(t)),t.type=r}else this._hoveredFeatures=null}_fireEvent(t,e,o){const s=this._map,r=s.transform,c=typeof e=="string"?e:e.type;return c==="move"&&this._updateViewState(this.props,!1),c in F&&(typeof e=="object"&&(e.viewState=J(r)),this._map.isMoving())?(s.transform=this._renderTransform,t.call(s,e,o),s.transform=r,s):(t.call(s,e,o),s)}_onBeforeRepaint(){const t=this._map;this._internalUpdate=!0;for(const o in this._deferredEvents)this._deferredEvents[o]&&t.fire(o);this._internalUpdate=!1;const e=this._map.transform;this._map.transform=this._renderTransform,this._onAfterRepaint=()=>{this._map.transform=e}}}L.savedMaps=[];function kt(){let n=null;if(typeof location<"u"){const t=/access_token=([^&\/]*)/.exec(location.search);n=t&&t[1]}try{n=n||{}.MapboxAccessToken}catch{}try{n=n||{}.REACT_APP_MAPBOX_ACCESS_TOKEN}catch{}return n}const Ot=["setMaxBounds","setMinZoom","setMaxZoom","setMinPitch","setMaxPitch","setRenderWorldCopies","setProjection","setStyle","addSource","removeSource","addLayer","removeLayer","setLayerZoomRange","setFilter","setPaintProperty","setLayoutProperty","setLight","setTerrain","setFog","remove"];function zt(n,t){if(!n)return null;const e=n.map,o={getMap:()=>e,getCenter:()=>n.transform.center,getZoom:()=>n.transform.zoom,getBearing:()=>n.transform.bearing,getPitch:()=>n.transform.pitch,getPadding:()=>n.transform.padding,getBounds:()=>n.transform.getBounds(),project:s=>n.transform.locationPoint(t.LngLat.convert(s)),unproject:s=>n.transform.pointLocation(t.Point.convert(s)),queryTerrainElevation:(s,r)=>{const c=e.transform;e.transform=n.transform;const l=e.queryTerrainElevation(s,r);return e.transform=c,l}};for(const s of It(e))!(s in o)&&!Ot.includes(s)&&(o[s]=e[s].bind(e));return o}function It(n){const t=new Set;let e=n;for(;e;){for(const o of Object.getOwnPropertyNames(e))o[0]!=="_"&&typeof n[o]=="function"&&o!=="fire"&&o!=="setEventedParent"&&t.add(o);e=Object.getPrototypeOf(e)}return Array.from(t)}const Zt=typeof document<"u"?f.useLayoutEffect:f.useEffect,Ft=["baseApiUrl","maxParallelImageRequests","workerClass","workerCount","workerUrl"];function Dt(n,t){for(const e of Ft)e in t&&(n[e]=t[e]);t.RTLTextPlugin&&n.getRTLTextPluginStatus&&n.getRTLTextPluginStatus()==="unavailable"&&n.setRTLTextPlugin(t.RTLTextPlugin,e=>{e&&console.error(e)},!1)}const z=f.createContext(null),$t={minZoom:0,maxZoom:22,minPitch:0,maxPitch:60,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,mapStyle:{version:8,sources:{},layers:[]},styleDiffing:!0,projection:"mercator",renderWorldCopies:!0,onError:n=>console.error(n.error),RTLTextPlugin:"https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-rtl-text/v0.2.3/mapbox-gl-rtl-text.js"},W=f.forwardRef((n,t)=>{const e=f.useContext(Tt),[o,s]=f.useState(null),r=f.useRef(),{current:c}=f.useRef({mapLib:null,map:null});f.useEffect(()=>{const a=n.mapLib;let d=!0,u;return Promise.resolve(a||vt(()=>import("./mapbox-gl-837b15d8.js").then(h=>h.m),["assets/mapbox-gl-837b15d8.js","assets/index-c0567344.js","assets/index-33278fe1.css"])).then(h=>{if(d){if(h.Map||(h=h.default),!h||!h.Map)throw new Error("Invalid mapLib");if(Dt(h,n),!h.supported||h.supported(n))n.reuseMaps&&(u=L.reuse(n,r.current)),u||(u=new L(h.Map,n,r.current)),c.map=zt(u,h),c.mapLib=h,s(u),e==null||e.onMapMount(c.map,n.id);else throw new Error("Map is not supported by this browser")}}).catch(h=>{n.onError({type:"error",target:null,originalEvent:null,error:h})}),()=>{d=!1,u&&(e==null||e.onMapUnmount(n.id),n.reuseMaps?u.recycle():u.destroy())}},[]),Zt(()=>{o&&o.setProps(n)}),f.useImperativeHandle(t,()=>c.map,[o]);const l=f.useMemo(()=>({position:"relative",width:"100%",height:"100%",...n.style}),[n.style]),i={height:"100%"};return f.createElement("div",{id:n.id,ref:r,style:l},o&&f.createElement(z.Provider,{value:c},f.createElement("div",{"mapboxgl-children":"",style:i},n.children)))});W.displayName="Map";W.defaultProps=$t;const Ut=/box|flex|grid|column|lineHeight|fontWeight|opacity|order|tabSize|zIndex/;function T(n,t){if(!n||!t)return;const e=n.style;for(const o in t){const s=t[o];Number.isFinite(s)&&!Ut.test(o)?e[o]=`${s}px`:e[o]=s}}const Bt={draggable:!1,popup:null,rotation:0,rotationAlignment:"auto",pitchAlignment:"auto"};function dt(n){const{map:t,mapLib:e}=f.useContext(z),o=f.useRef({props:n});o.current.props=n;const s=f.useMemo(()=>{let r=!1;f.Children.forEach(n.children,i=>{i&&(r=!0)});const c={...n,element:r?document.createElement("div"):null},l=new e.Marker(c).setLngLat([n.longitude,n.latitude]);return l.getElement().addEventListener("click",i=>{var a,d;(d=(a=o.current.props).onClick)===null||d===void 0||d.call(a,{type:"click",target:l,originalEvent:i})}),l.on("dragstart",i=>{var a,d;const u=i;u.lngLat=s.getLngLat(),(d=(a=o.current.props).onDragStart)===null||d===void 0||d.call(a,u)}),l.on("drag",i=>{var a,d;const u=i;u.lngLat=s.getLngLat(),(d=(a=o.current.props).onDrag)===null||d===void 0||d.call(a,u)}),l.on("dragend",i=>{var a,d;const u=i;u.lngLat=s.getLngLat(),(d=(a=o.current.props).onDragEnd)===null||d===void 0||d.call(a,u)}),l},[]);return f.useEffect(()=>(s.addTo(t.getMap()),()=>{s.remove()}),[]),f.useEffect(()=>{T(s.getElement(),n.style)},[n.style]),(s.getLngLat().lng!==n.longitude||s.getLngLat().lat!==n.latitude)&&s.setLngLat([n.longitude,n.latitude]),n.offset&&!Rt(s.getOffset(),n.offset)&&s.setOffset(n.offset),s.isDraggable()!==n.draggable&&s.setDraggable(n.draggable),s.getRotation()!==n.rotation&&s.setRotation(n.rotation),s.getRotationAlignment()!==n.rotationAlignment&&s.setRotationAlignment(n.rotationAlignment),s.getPitchAlignment()!==n.pitchAlignment&&s.setPitchAlignment(n.pitchAlignment),s.getPopup()!==n.popup&&s.setPopup(n.popup),ct.createPortal(n.children,s.getElement())}dt.defaultProps=Bt;const tt=f.memo(dt);function et(n){return new Set(n?n.trim().split(/\s+/):[])}function Ht(n){const{map:t,mapLib:e}=f.useContext(z),o=f.useMemo(()=>document.createElement("div"),[]),s=f.useRef({props:n});s.current.props=n;const r=f.useMemo(()=>{const c={...n},l=new e.Popup(c).setLngLat([n.longitude,n.latitude]);return l.once("open",i=>{var a,d;(d=(a=s.current.props).onOpen)===null||d===void 0||d.call(a,i)}),l},[]);if(f.useEffect(()=>{const c=l=>{var i,a;(a=(i=s.current.props).onClose)===null||a===void 0||a.call(i,l)};return r.on("close",c),r.setDOMContent(o).addTo(t.getMap()),()=>{r.off("close",c),r.isOpen()&&r.remove()}},[]),f.useEffect(()=>{T(r.getElement(),n.style)},[n.style]),r.isOpen()&&((r.getLngLat().lng!==n.longitude||r.getLngLat().lat!==n.latitude)&&r.setLngLat([n.longitude,n.latitude]),n.offset&&!M(r.options.offset,n.offset)&&r.setOffset(n.offset),(r.options.anchor!==n.anchor||r.options.maxWidth!==n.maxWidth)&&(r.options.anchor=n.anchor,r.setMaxWidth(n.maxWidth)),r.options.className!==n.className)){const c=et(r.options.className),l=et(n.className);for(const i of c)l.has(i)||r.removeClassName(i);for(const i of l)c.has(i)||r.addClassName(i);r.options.className=n.className}return ct.createPortal(n.children,o)}f.memo(Ht);function j(n,t,e,o){const s=f.useContext(z),r=f.useMemo(()=>n(s),[]);return f.useEffect(()=>{const c=o||e||t,l=typeof t=="function"&&typeof e=="function"?t:null,i=typeof e=="function"?e:typeof t=="function"?t:null,{map:a}=s;return a.hasControl(r)||(a.addControl(r,c==null?void 0:c.position),l&&l(s)),()=>{i&&i(s),a.hasControl(r)&&a.removeControl(r)}},[]),r}function Wt(n){const t=j(({mapLib:e})=>new e.AttributionControl(n),{position:n.position});return f.useEffect(()=>{T(t._container,n.style)},[n.style]),null}f.memo(Wt);function Gt(n){const t=j(({mapLib:e})=>new e.FullscreenControl({container:n.containerId&&document.getElementById(n.containerId)}),{position:n.position});return f.useEffect(()=>{T(t._controlContainer,n.style)},[n.style]),null}f.memo(Gt);const ht=f.forwardRef((n,t)=>{const e=f.useRef({props:n}),o=j(({mapLib:s})=>{const r=new s.GeolocateControl(n),c=r._setupUI;return r._setupUI=l=>{r._container.hasChildNodes()||c(l)},r.on("geolocate",l=>{var i,a;(a=(i=e.current.props).onGeolocate)===null||a===void 0||a.call(i,l)}),r.on("error",l=>{var i,a;(a=(i=e.current.props).onError)===null||a===void 0||a.call(i,l)}),r.on("outofmaxbounds",l=>{var i,a;(a=(i=e.current.props).onOutOfMaxBounds)===null||a===void 0||a.call(i,l)}),r.on("trackuserlocationstart",l=>{var i,a;(a=(i=e.current.props).onTrackUserLocationStart)===null||a===void 0||a.call(i,l)}),r.on("trackuserlocationend",l=>{var i,a;(a=(i=e.current.props).onTrackUserLocationEnd)===null||a===void 0||a.call(i,l)}),r},{position:n.position});return e.current.props=n,f.useImperativeHandle(t,()=>({trigger:()=>o.trigger()}),[]),f.useEffect(()=>{T(o._container,n.style)},[n.style]),null});ht.displayName="GeolocateControl";f.memo(ht);function qt(n){const t=j(({mapLib:e})=>new e.NavigationControl(n),{position:n.position});return f.useEffect(()=>{T(t._container,n.style)},[n.style]),null}f.memo(qt);const Qt={unit:"metric",maxWidth:100};function ft(n){const t=j(({mapLib:e})=>new e.ScaleControl(n),{position:n.position});return(t.options.unit!==n.unit||t.options.maxWidth!==n.maxWidth)&&(t.options.maxWidth=n.maxWidth,t.setUnit(n.unit)),f.useEffect(()=>{T(t._container,n.style)},[n.style]),null}ft.defaultProps=Qt;f.memo(ft);const nt=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array],D=1,N=8;class G{static from(t){if(!(t instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[e,o]=new Uint8Array(t,0,2);if(e!==219)throw new Error("Data does not appear to be in a KDBush format.");const s=o>>4;if(s!==D)throw new Error(`Got v${s} data when expected v${D}.`);const r=nt[o&15];if(!r)throw new Error("Unrecognized array type.");const[c]=new Uint16Array(t,2,1),[l]=new Uint32Array(t,4,1);return new G(l,c,r,t)}constructor(t,e=64,o=Float64Array,s){if(isNaN(t)||t<0)throw new Error(`Unpexpected numItems value: ${t}.`);this.numItems=+t,this.nodeSize=Math.min(Math.max(+e,2),65535),this.ArrayType=o,this.IndexArrayType=t<65536?Uint16Array:Uint32Array;const r=nt.indexOf(this.ArrayType),c=t*2*this.ArrayType.BYTES_PER_ELEMENT,l=t*this.IndexArrayType.BYTES_PER_ELEMENT,i=(8-l%8)%8;if(r<0)throw new Error(`Unexpected typed array class: ${o}.`);s&&s instanceof ArrayBuffer?(this.data=s,this.ids=new this.IndexArrayType(this.data,N,t),this.coords=new this.ArrayType(this.data,N+l+i,t*2),this._pos=t*2,this._finished=!0):(this.data=new ArrayBuffer(N+c+l+i),this.ids=new this.IndexArrayType(this.data,N,t),this.coords=new this.ArrayType(this.data,N+l+i,t*2),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,(D<<4)+r]),new Uint16Array(this.data,2,1)[0]=e,new Uint32Array(this.data,4,1)[0]=t)}add(t,e){const o=this._pos>>1;return this.ids[o]=o,this.coords[this._pos++]=t,this.coords[this._pos++]=e,o}finish(){const t=this._pos>>1;if(t!==this.numItems)throw new Error(`Added ${t} items when expected ${this.numItems}.`);return H(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(t,e,o,s){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:r,coords:c,nodeSize:l}=this,i=[0,r.length-1,0],a=[];for(;i.length;){const d=i.pop()||0,u=i.pop()||0,h=i.pop()||0;if(u-h<=l){for(let v=h;v<=u;v++){const _=c[2*v],w=c[2*v+1];_>=t&&_<=o&&w>=e&&w<=s&&a.push(r[v])}continue}const m=h+u>>1,g=c[2*m],y=c[2*m+1];g>=t&&g<=o&&y>=e&&y<=s&&a.push(r[m]),(d===0?t<=g:e<=y)&&(i.push(h),i.push(m-1),i.push(1-d)),(d===0?o>=g:s>=y)&&(i.push(m+1),i.push(u),i.push(1-d))}return a}within(t,e,o){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:s,coords:r,nodeSize:c}=this,l=[0,s.length-1,0],i=[],a=o*o;for(;l.length;){const d=l.pop()||0,u=l.pop()||0,h=l.pop()||0;if(u-h<=c){for(let v=h;v<=u;v++)ot(r[2*v],r[2*v+1],t,e)<=a&&i.push(s[v]);continue}const m=h+u>>1,g=r[2*m],y=r[2*m+1];ot(g,y,t,e)<=a&&i.push(s[m]),(d===0?t-o<=g:e-o<=y)&&(l.push(h),l.push(m-1),l.push(1-d)),(d===0?t+o>=g:e+o>=y)&&(l.push(m+1),l.push(u),l.push(1-d))}return i}}function H(n,t,e,o,s,r){if(s-o<=e)return;const c=o+s>>1;mt(n,t,c,o,s,r),H(n,t,e,o,c-1,1-r),H(n,t,e,c+1,s,1-r)}function mt(n,t,e,o,s,r){for(;s>o;){if(s-o>600){const a=s-o+1,d=e-o+1,u=Math.log(a),h=.5*Math.exp(2*u/3),m=.5*Math.sqrt(u*h*(a-h)/a)*(d-a/2<0?-1:1),g=Math.max(o,Math.floor(e-d*h/a+m)),y=Math.min(s,Math.floor(e+(a-d)*h/a+m));mt(n,t,e,g,y,r)}const c=t[2*e+r];let l=o,i=s;for(R(n,t,o,e),t[2*s+r]>c&&R(n,t,o,s);l<i;){for(R(n,t,l,i),l++,i--;t[2*l+r]<c;)l++;for(;t[2*i+r]>c;)i--}t[2*o+r]===c?R(n,t,o,i):(i++,R(n,t,i,s)),i<=e&&(o=i+1),e<=i&&(s=i-1)}}function R(n,t,e,o){$(n,e,o),$(t,2*e,2*o),$(t,2*e+1,2*o+1)}function $(n,t,e){const o=n[t];n[t]=n[e],n[e]=o}function ot(n,t,e,o){const s=n-e,r=t-o;return s*s+r*r}const Jt={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:n=>n},st=Math.fround||(n=>t=>(n[0]=+t,n[0]))(new Float32Array(1)),S=2,E=3,U=4,b=5,pt=6;class Kt{constructor(t){this.options=Object.assign(Object.create(Jt),t),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(t){const{log:e,minZoom:o,maxZoom:s}=this.options;e&&console.time("total time");const r=`prepare ${t.length} points`;e&&console.time(r),this.points=t;const c=[];for(let i=0;i<t.length;i++){const a=t[i];if(!a.geometry)continue;const[d,u]=a.geometry.coordinates,h=st(P(d)),m=st(k(u));c.push(h,m,1/0,i,-1,1),this.options.reduce&&c.push(0)}let l=this.trees[s+1]=this._createTree(c);e&&console.timeEnd(r);for(let i=s;i>=o;i--){const a=+Date.now();l=this.trees[i]=this._createTree(this._cluster(l,i)),e&&console.log("z%d: %d clusters in %dms",i,l.numItems,+Date.now()-a)}return e&&console.timeEnd("total time"),this}getClusters(t,e){let o=((t[0]+180)%360+360)%360-180;const s=Math.max(-90,Math.min(90,t[1]));let r=t[2]===180?180:((t[2]+180)%360+360)%360-180;const c=Math.max(-90,Math.min(90,t[3]));if(t[2]-t[0]>=360)o=-180,r=180;else if(o>r){const u=this.getClusters([o,s,180,c],e),h=this.getClusters([-180,s,r,c],e);return u.concat(h)}const l=this.trees[this._limitZoom(e)],i=l.range(P(o),k(c),P(r),k(s)),a=l.data,d=[];for(const u of i){const h=this.stride*u;d.push(a[h+b]>1?rt(a,h,this.clusterProps):this.points[a[h+E]])}return d}getChildren(t){const e=this._getOriginId(t),o=this._getOriginZoom(t),s="No cluster with the specified id.",r=this.trees[o];if(!r)throw new Error(s);const c=r.data;if(e*this.stride>=c.length)throw new Error(s);const l=this.options.radius/(this.options.extent*Math.pow(2,o-1)),i=c[e*this.stride],a=c[e*this.stride+1],d=r.within(i,a,l),u=[];for(const h of d){const m=h*this.stride;c[m+U]===t&&u.push(c[m+b]>1?rt(c,m,this.clusterProps):this.points[c[m+E]])}if(u.length===0)throw new Error(s);return u}getLeaves(t,e,o){e=e||10,o=o||0;const s=[];return this._appendLeaves(s,t,e,o,0),s}getTile(t,e,o){const s=this.trees[this._limitZoom(t)],r=Math.pow(2,t),{extent:c,radius:l}=this.options,i=l/c,a=(o-i)/r,d=(o+1+i)/r,u={features:[]};return this._addTileFeatures(s.range((e-i)/r,a,(e+1+i)/r,d),s.data,e,o,r,u),e===0&&this._addTileFeatures(s.range(1-i/r,a,1,d),s.data,r,o,r,u),e===r-1&&this._addTileFeatures(s.range(0,a,i/r,d),s.data,-1,o,r,u),u.features.length?u:null}getClusterExpansionZoom(t){let e=this._getOriginZoom(t)-1;for(;e<=this.options.maxZoom;){const o=this.getChildren(t);if(e++,o.length!==1)break;t=o[0].properties.cluster_id}return e}_appendLeaves(t,e,o,s,r){const c=this.getChildren(e);for(const l of c){const i=l.properties;if(i&&i.cluster?r+i.point_count<=s?r+=i.point_count:r=this._appendLeaves(t,i.cluster_id,o,s,r):r<s?r++:t.push(l),t.length===o)break}return r}_createTree(t){const e=new G(t.length/this.stride|0,this.options.nodeSize,Float32Array);for(let o=0;o<t.length;o+=this.stride)e.add(t[o],t[o+1]);return e.finish(),e.data=t,e}_addTileFeatures(t,e,o,s,r,c){for(const l of t){const i=l*this.stride,a=e[i+b]>1;let d,u,h;if(a)d=gt(e,i,this.clusterProps),u=e[i],h=e[i+1];else{const y=this.points[e[i+E]];d=y.properties;const[v,_]=y.geometry.coordinates;u=P(v),h=k(_)}const m={type:1,geometry:[[Math.round(this.options.extent*(u*r-o)),Math.round(this.options.extent*(h*r-s))]],tags:d};let g;a||this.options.generateId?g=e[i+E]:g=this.points[e[i+E]].id,g!==void 0&&(m.id=g),c.features.push(m)}}_limitZoom(t){return Math.max(this.options.minZoom,Math.min(Math.floor(+t),this.options.maxZoom+1))}_cluster(t,e){const{radius:o,extent:s,reduce:r,minPoints:c}=this.options,l=o/(s*Math.pow(2,e)),i=t.data,a=[],d=this.stride;for(let u=0;u<i.length;u+=d){if(i[u+S]<=e)continue;i[u+S]=e;const h=i[u],m=i[u+1],g=t.within(i[u],i[u+1],l),y=i[u+b];let v=y;for(const _ of g){const w=_*d;i[w+S]>e&&(v+=i[w+b])}if(v>y&&v>=c){let _=h*y,w=m*y,x,q=-1;const I=((u/d|0)<<5)+(e+1)+this.points.length;for(const yt of g){const C=yt*d;if(i[C+S]<=e)continue;i[C+S]=e;const Q=i[C+b];_+=i[C]*Q,w+=i[C+1]*Q,i[C+U]=I,r&&(x||(x=this._map(i,u,!0),q=this.clusterProps.length,this.clusterProps.push(x)),r(x,this._map(i,C)))}i[u+U]=I,a.push(_/v,w/v,1/0,I,-1,v),r&&a.push(q)}else{for(let _=0;_<d;_++)a.push(i[u+_]);if(v>1)for(const _ of g){const w=_*d;if(!(i[w+S]<=e)){i[w+S]=e;for(let x=0;x<d;x++)a.push(i[w+x])}}}}return a}_getOriginId(t){return t-this.points.length>>5}_getOriginZoom(t){return(t-this.points.length)%32}_map(t,e,o){if(t[e+b]>1){const c=this.clusterProps[t[e+pt]];return o?Object.assign({},c):c}const s=this.points[t[e+E]].properties,r=this.options.map(s);return o&&r===s?Object.assign({},r):r}}function rt(n,t,e){return{type:"Feature",id:n[t+E],properties:gt(n,t,e),geometry:{type:"Point",coordinates:[Vt(n[t]),Yt(n[t+1])]}}}function gt(n,t,e){const o=n[t+b],s=o>=1e4?`${Math.round(o/1e3)}k`:o>=1e3?`${Math.round(o/100)/10}k`:o,r=n[t+pt],c=r===-1?{}:Object.assign({},e[r]);return Object.assign(c,{cluster:!0,cluster_id:n[t+E],point_count:o,point_count_abbreviated:s})}function P(n){return n/360+.5}function k(n){const t=Math.sin(n*Math.PI/180),e=.5-.25*Math.log((1+t)/(1-t))/Math.PI;return e<0?0:e>1?1:e}function Vt(n){return(n-.5)*360}function Yt(n){const t=(180-n*360)*Math.PI/180;return 360*Math.atan(Math.exp(t))/Math.PI-90}var it=Object.prototype.hasOwnProperty;function at(n,t,e){for(e of n.keys())if(A(e,t))return e}function A(n,t){var e,o,s;if(n===t)return!0;if(n&&t&&(e=n.constructor)===t.constructor){if(e===Date)return n.getTime()===t.getTime();if(e===RegExp)return n.toString()===t.toString();if(e===Array){if((o=n.length)===t.length)for(;o--&&A(n[o],t[o]););return o===-1}if(e===Set){if(n.size!==t.size)return!1;for(o of n)if(s=o,s&&typeof s=="object"&&(s=at(t,s),!s)||!t.has(s))return!1;return!0}if(e===Map){if(n.size!==t.size)return!1;for(o of n)if(s=o[0],s&&typeof s=="object"&&(s=at(t,s),!s)||!A(o[1],t.get(s)))return!1;return!0}if(e===ArrayBuffer)n=new Uint8Array(n),t=new Uint8Array(t);else if(e===DataView){if((o=n.byteLength)===t.byteLength)for(;o--&&n.getInt8(o)===t.getInt8(o););return o===-1}if(ArrayBuffer.isView(n)){if((o=n.byteLength)===t.byteLength)for(;o--&&n[o]===t[o];);return o===-1}if(!e||typeof n=="object"){o=0;for(e in n)if(it.call(n,e)&&++o&&!it.call(t,e)||!(e in t)||!A(n[e],t[e]))return!1;return Object.keys(t).length===o}}return n!==n&&t!==t}function Xt(n){var t=f.useRef(n),e=f.useRef(0);return A(n,t.current)||(t.current=n,e.current+=1),f.useMemo(function(){return t.current},[e.current])}function te(n,t){return f.useEffect(n,Xt(t))}var ee=function(t){var e=t.points,o=t.bounds,s=t.zoom,r=t.options,c=f.useRef(),l=f.useRef(),i=f.useState([]),a=i[0],d=i[1],u=Math.round(s);return te(function(){(!c.current||!A(l.current,e)||!A(c.current.options,r))&&(c.current=new Kt(r),c.current.load(e)),o&&d(c.current.getClusters(o,u)),l.current=e},[e,o,u,r]),{clusters:a,supercluster:c.current}};const ne={latitude:-32.7316,longitude:151.5525},oe=({children:n,notAtHomesList:t})=>{const[e,o]=f.useState({latitude:52.6376,longitude:-1.135171,width:"100vw",height:"100vh",zoom:12}),{ternaryDarkMode:s}=_t(),r=f.useRef(null),c=t.filter(u=>u.lat!==void 0).map(u=>({type:"Feature",properties:{cluster:!1,crimeId:u.id,category:u.houseNumber},geometry:{type:"Point",coordinates:[u.lng,u.lat]}})),l={radius:75,maxZoom:20},i=r.current?r.current.getMap().getBounds().toArray().flat():null,{clusters:a,supercluster:d}=ee({points:c,bounds:i,zoom:e.zoom,options:l});return p.jsx("div",{className:"h-full",children:p.jsx(W,{initialViewState:{...ne,zoom:e.zoom},mapStyle:`mapbox://styles/damianamodeo/${s?"clefix5la000901po4wflstdd":"clefifzvz000u01nw8h84n67m"}`,mapboxAccessToken:"pk.eyJ1IjoiZGFtaWFuYW1vZGVvIiwiYSI6ImNqeWxnb3lsejA4OXozYmxpajhzMXdvZjQifQ.OJBOK5ZvGEX2VaScbW_zUQ",ref:r,onMoveEnd:u=>{o({...e,zoom:r.current?r.current.getZoom():null})},style:{width:"100%",height:"100%"},children:a.map(u=>{const[h,m]=u.geometry.coordinates,{cluster:g,point_count:y,category:v}=u.properties;return u.properties.id,g?p.jsx(tt,{latitude:m,longitude:h,children:p.jsx("div",{className:"cluster-marker",style:{width:`${10+y/c.length*20}px`,height:`${10+y/c.length*20}px`},onClick:_=>{var w;(w=r.current)==null||w.easeTo({center:[h,m],zoom:d==null?void 0:d.getClusterExpansionZoom(u.id),duration:500}),o({...e,zoom:d==null?void 0:d.getClusterExpansionZoom(u.id)})},children:p.jsx("div",{className:"w-20 h-20 bg-white grid place-items-center rounded-full",children:y})})},`cluster-${u.id}`):p.jsx(tt,{latitude:m,longitude:h,children:p.jsxs("button",{className:"bg-red-500 rounded-full w-8 h-8",children:[v," "]})},`crime-${u.properties.crimeId}`)})})})},se=({children:n,notAtHomesList:t})=>p.jsx("div",{className:"h-full",children:p.jsx(oe,{notAtHomesList:t})}),de=({changeSubpage:n})=>{const[t,e]=f.useState([{key:""}]),[o,s]=f.useState([]),[r,c]=f.useState([]);return f.useEffect(()=>Mt(lt(B,"notAtHomes","MaitlandCongregation"),i=>{const a=i.data(),d=a?Object.keys(a).map(u=>({key:u,...a[u]})):[];e(d),s(d.reduce((u,h)=>{if(h.letter)return u;const m=u.findIndex(g=>g.mapNumber===`${h.mapNumber}`);if(m<0)u.push({mapNumber:h.mapNumber,total:1,streets:[{street:h.street,addresses:[h]}]});else{u[m].total=u[m].total+1;const g=u[m].streets.findIndex(y=>y.street===`${h.street}`);g<0?u[m].streets.push({street:h.street,addresses:[h]}):u[m].streets[g].addresses.push(h)}return u},[])),c(d.reduce((u,h)=>{if(h.letter)return u;const m=u.findIndex(g=>g.suburb===`${h.suburb}`);if(m<0)u.push({suburb:h.suburb,total:1,streets:[{street:h.street,addresses:[h]}]});else{u[m].total=u[m].total+1;const g=u[m].streets.findIndex(y=>y.street===`${h.street}`);g<0?u[m].streets.push({street:h.street,addresses:[h]}):u[m].streets[g].addresses.push(h)}return u},[]))}),[]),p.jsx("div",{className:"h-full",children:p.jsx(xt,{color:"blue",tabItems:[{title:"Map View",content:p.jsx(se,{notAtHomesList:t})},{title:"Suburb",content:p.jsx(St,{suburbs:r})},{title:"Map ID",content:p.jsx(At,{mapNumbers:o})}]})})};export{de as default};
