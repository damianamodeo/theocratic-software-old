import{j as t,r as a,_ as v}from"./index-77827b4c.js";import{M as A,B as j,T as S}from"./Modal-c26335ab.js";import{r as w,f as N,b as k,d as _,c as $}from"./deleteNotAtHome-63823a81.js";import{A as g}from"./Disclosure-33565afa.js";const y=async(u,s,l)=>{const h=w(N,"notAtHomes","MaitlandCongregation");try{return await k(N,async x=>{const i=await x.get(h).then(p=>p.data());x.update(h,{...i,[u.key]:{...i[u.key],[s]:l}})})}catch(m){return console.error(m.message),m}},I=({isOpen:u,address:s,setModalOpen:l})=>t.jsxs(A,{isOpen:u,onClose:()=>{},title:"",height:"md",children:[t.jsxs("div",{className:"h-full text-center text-xl dark:text-white",children:[(s==null?void 0:s.unitNumber)&&`${s==null?void 0:s.unitNumber}/`,s==null?void 0:s.houseNumber," ",s==null?void 0:s.street,", ",s==null?void 0:s.suburb]}),t.jsxs("div",{className:"grid place-items-center gap-4",children:[t.jsx(j,{width:"md",clickAction:()=>l(!1),color:"blue",children:"cancel"}),t.jsx(j,{width:"md",clickAction:()=>{y(s,"letter",!0),l(!1)},color:"blue",children:"Letter List"}),t.jsx(j,{width:"md",clickAction:()=>{_(s),l(!1)},color:"blue",children:"Delete"})]})]}),L=({suburbs:u})=>{const[s,l]=a.useState(void 0),[h,m]=a.useState(!1);let x=Date.now();return a.useEffect(()=>{},[]),t.jsx(t.Fragment,{children:Date.now()>x+3e3?"":t.jsxs("div",{className:"",children:[t.jsx(I,{address:s,isOpen:h,setModalOpen:m}),u.filter(i=>i.suburb!==void 0).sort((i,p)=>p.total-i.total).map((i,p)=>t.jsx("div",{className:"mx-auto w-full max-w-md p-2",children:t.jsx(g,{title:t.jsxs("div",{className:"p-3 text-2xl",children:[`${i.suburb} (${i.total})`," "]}),children:i.streets.sort((c,d)=>c.street.localeCompare(d.street)).map((c,d)=>t.jsx("div",{className:"my-2 mx-6",children:t.jsx(g,{title:t.jsx("div",{className:"p-2 w-full bg-neutral-200 dark:bg-neutral-700 rounded",children:`${c.street} ${c.addresses.length}`}),children:t.jsx("div",{className:" grid grid-cols-[repeat(auto-fill,minmax(3.5rem,1fr))]",children:c.addresses.sort((o,e)=>{const r=String(o.unitNumber*.001)+String(o.unitNumber*.001),n=String(e.unitNumber*.001)+String(e.unitNumber*.001);return r.toLowerCase().localeCompare(n)}).map((o,e)=>t.jsx("div",{children:t.jsxs("div",{onClick:()=>{l(o),m(!0)},className:`m-1 py-2 rounded text-center dark:text-white ${o.houseNumber%2===0?"dark:bg-neutral-600 bg-neutral-300":"dark:bg-neutral-800 bg-neutral-400"}`,children:[o.unitNumber&&`${o.unitNumber}/`,o.houseNumber]})},e))})},d)},d))})},p))]})})},M=a.lazy(()=>v(()=>import("./MapView-ae4d6163.js"),["assets/MapView-ae4d6163.js","assets/index-77827b4c.js","assets/index-b8bd47ee.css","assets/Modal-c26335ab.js","assets/transition-80610d22.js","assets/deleteNotAtHome-63823a81.js","assets/Disclosure-33565afa.js","assets/upDownArrow-4f99c3cf.js","assets/MapView-22a139a9.css"])),C=({changeSubpage:u})=>{const[s,l]=a.useState([{key:""}]),[h,m]=a.useState([]),[x,i]=a.useState([]);return a.useEffect(()=>$(w(N,"notAtHomes","MaitlandCongregation"),c=>{const d=c.data(),o=d?Object.keys(d).map(e=>({key:e,...d[e]})):[];l(o),m(o.reduce((e,r)=>{if(r.letter)return e;const n=e.findIndex(b=>b.mapNumber===`${r.mapNumber}`);if(n<0)e.push({mapNumber:r.mapNumber,total:1,streets:[{street:r.street,addresses:[r]}]});else{e[n].total=e[n].total+1;const b=e[n].streets.findIndex(f=>f.street===`${r.street}`);b<0?e[n].streets.push({street:r.street,addresses:[r]}):e[n].streets[b].addresses.push(r)}return e},[])),i(o.reduce((e,r)=>{if(r.letter)return e;const n=e.findIndex(b=>b.suburb===`${r.suburb}`);if(n<0)e.push({suburb:r.suburb,total:1,streets:[{street:r.street,addresses:[r]}]});else{e[n].total=e[n].total+1;const b=e[n].streets.findIndex(f=>f.street===`${r.street}`);b<0?e[n].streets.push({street:r.street,addresses:[r]}):e[n].streets[b].addresses.push(r)}return e},[]))}),[]),t.jsx("div",{className:"h-full",children:t.jsx(S,{color:"blue",tabItems:[{title:"Map View",content:t.jsx(a.Suspense,{fallback:t.jsx("div",{children:"Loading..."}),children:t.jsx(M,{notAtHomesList:s})})},{title:"List View",content:t.jsx(L,{suburbs:x})}]})})},O=Object.freeze(Object.defineProperty({__proto__:null,default:C},Symbol.toStringTag,{value:"Module"}));export{O as R,I as U};
